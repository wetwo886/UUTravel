/**11
 * @license RequireJS text 2.0.12 Copyright (c) 2010-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details                    
 */

var SYSTEM_PATH={BASE_PATH:"",VIEW_PATH:"src/views/",CONTROLLER_PATH:"src/controllers/",MODEL_PATH:"src/models/",STORE_PATH:"src/stores/",UTIL_PATH:"src/util/",WIDGET_PATH:"src/widget/"};require.config({baseUrl:window.SYSTEM_PATH.BASE_PATH,shim:{},paths:{NttTravelBaseModel:SYSTEM_PATH.MODEL_PATH+"ntt.travel.base.model",PlaceListBaseController:SYSTEM_PATH.CONTROLLER_PATH+"place.list.base.controller",NttTravelBaseController:SYSTEM_PATH.CONTROLLER_PATH+"ntt.travel.base.controller",ClickFavoriteModel:SYSTEM_PATH.MODEL_PATH+"click.favorite.model",NttNavWidget:SYSTEM_PATH.WIDGET_PATH+"ntt.nav.widget",NttShareWidget:SYSTEM_PATH.WIDGET_PATH+"ntt.share.widget",MsImageSliderWidget:SYSTEM_PATH.WIDGET_PATH+"ms.image.slider.widget",FavoriteStore:SYSTEM_PATH.STORE_PATH+"favorite.store",IndexHotCityStore:SYSTEM_PATH.STORE_PATH+"index.hotcity.store",IndexBannerStore:SYSTEM_PATH.STORE_PATH+"index.banner.store",TravelTypeStore:SYSTEM_PATH.STORE_PATH+"travel.type.store",IndexController:SYSTEM_PATH.CONTROLLER_PATH+"index",IndexViewHtml:SYSTEM_PATH.VIEW_PATH+"index.html",IndexBannerModel:SYSTEM_PATH.MODEL_PATH+"index.banner.model",IndexHotCityModel:SYSTEM_PATH.MODEL_PATH+"index.hotcity.model",TravelTypeModel:SYSTEM_PATH.MODEL_PATH+"travel.type.model",ScenicListController:SYSTEM_PATH.CONTROLLER_PATH+"scenic.list",ScenicListViewHtml:SYSTEM_PATH.VIEW_PATH+"scenic.list.html",ScenicListModel:SYSTEM_PATH.MODEL_PATH+"scenic.list.model",RecommendListController:SYSTEM_PATH.CONTROLLER_PATH+"recommend.list",RecommendListViewHtml:SYSTEM_PATH.VIEW_PATH+"recommend.list.html",RecommendListModel:SYSTEM_PATH.MODEL_PATH+"recommend.list.model",SubregionListModel:SYSTEM_PATH.MODEL_PATH+"subregion.list.model",ScenicDetailController:SYSTEM_PATH.CONTROLLER_PATH+"scenic.detail",ScenicDetailViewHtml:SYSTEM_PATH.VIEW_PATH+"scenic.detail.html",ScenicDetailStore:SYSTEM_PATH.STORE_PATH+"scenic.detail.store",FavoriteListController:SYSTEM_PATH.CONTROLLER_PATH+"favorite.list",FavoriteListViewHtml:SYSTEM_PATH.VIEW_PATH+"favorite.list.html",FavoriteListModel:SYSTEM_PATH.MODEL_PATH+"favorite.list.model",NearListController:SYSTEM_PATH.CONTROLLER_PATH+"near.list",NearListViewHtml:SYSTEM_PATH.VIEW_PATH+"near.list.html",NearListModel:SYSTEM_PATH.MODEL_PATH+"near.list.model",CityListController:SYSTEM_PATH.CONTROLLER_PATH+"city.list",CityListViewHtml:SYSTEM_PATH.VIEW_PATH+"city.list.html",CityListModel:SYSTEM_PATH.MODEL_PATH+"city.list.model",CityListStore:SYSTEM_PATH.STORE_PATH+"city.list.store",AboutUsController:SYSTEM_PATH.CONTROLLER_PATH+"about.us",AboutUsViewHtml:SYSTEM_PATH.VIEW_PATH+"about.us.html",UserSettingController:SYSTEM_PATH.CONTROLLER_PATH+"user.setting",UserSettingViewHtml:SYSTEM_PATH.VIEW_PATH+"user.setting.html",UserAgreementController:SYSTEM_PATH.CONTROLLER_PATH+"user.agreement",UserAgreementViewHtml:SYSTEM_PATH.VIEW_PATH+"user.agreement.html",UserAgreementStore:SYSTEM_PATH.STORE_PATH+"user.agreement.store",RecommendAppViewHtml:SYSTEM_PATH.VIEW_PATH+"recommend.app.html",RecommendAppController:SYSTEM_PATH.CONTROLLER_PATH+"recommend.app",AppUpdateDesViewHtml:SYSTEM_PATH.VIEW_PATH+"app.update.des.html",AppUpdateDesController:SYSTEM_PATH.CONTROLLER_PATH+"app.update.des",UserAgreementModel:SYSTEM_PATH.MODEL_PATH+"user.agreement.model",UserReportController:SYSTEM_PATH.CONTROLLER_PATH+"user.report",UserReportViewHtml:SYSTEM_PATH.VIEW_PATH+"user.report.html",UserReportModel:SYSTEM_PATH.MODEL_PATH+"user.report.model"}}),require(["MsApp"],function(e){window.onerror=function(e,t,n){alert(e+"\r\n"+t)};var t=new e({defaultController:"Index",basePath:"src/"});t.startup()}),define("main",function(){}),define("NttTravelBaseModel",["MsCore","MsModel","MsEnvt"],function(e,t,n){"use strict";var r={__propertys__:function($super){$super(),this.param={},n.getAppStatus()==="P"?this.url="117.121.128.16:54322/Master":this.url="117.121.128.16:54322/Master",this.path="接口路径，例如：/Region/Province/Get",this.useCache=!1,this.result={},this.userDataStore=null},initialize:function($super,e){$super(e)},execute:function($super,e){$super({onSuccess:e.onSuccess,onError:function(t){e.onError&&e.onError(t)}})}};return new e.Class(t,r)}),define("NttTravelBaseController",["MsCore","MsController"],function(e,t,n,r,i,s){"use strict";var o={ChangeCity:{name:"ChangeCity",text:"地区切换"},ChangePlaceClass:{name:"ChangePlaceClass",text:"分类切换"},PlaceListPaging:{name:"PlaceListPaging",text:"店铺列表翻页"},NearPlaceListPaging:{name:"NearPlaceListPaging",text:"周边列表翻页"},Favorite:{name:"Favorite",text:"收藏"},Suggestion:{name:"Suggestion",text:"意见反馈"}},u={isFromApp:function(){if(this.request.fsn==="app")return!0},handlePage:function($super,e){$super(e),window.hideHeaderFooter&&(e.find(".ms-header").remove(),e.find(".ms-footer").remove())},onBeforeShow:function(){var e=$(window).height();this.root.find(".ms-content").css("min-height",e-94)},setFavorite:function(){},showLoading:function($super,e){e=e||{noMask:!0},$super(e)},hideLoading:function($super){$super(),$("#ntt-mask")&&$("#ntt-mask").hide()},onHide:function($super){this.execBaiduMobtj&&(this.execBaiduMobtj=!1,window.BaiduMobStat&&window.BaiduMobStat.onPageEnd&&this.pageName&&window.BaiduMobStat.onPageEnd(this.pageName),console.log(this.pageName+"_hide")),this.hideLoading(),$super()},onBeforeJump:function($super){$super()},onShow:function(){this.execBaiduMobtj=!0,window.BaiduMobStat&&window.BaiduMobStat.onPageStart&&this.pageName&&window.BaiduMobStat.onPageStart(this.pageName)},setPageHeight:function(e){},sotreDetailUrl:function(e){var t=["nt_content="+encodeURIComponent(e.place_intro),"nt_imgurl="+encodeURIComponent(e.img),"nt_linkurl="+encodeURIComponent(e.place_link),"nt_title="+encodeURIComponent(e.place_name),"nt_id="+encodeURIComponent(e.place_id),"nt_type="+encodeURIComponent(e.type),"lat=100","lng=100"],n=e.place_link;return n},baiduEvent:function(e){this.execBaiduMobtj=!0,window.BaiduMobStat&&window.BaiduMobStat.onEvent&&window.BaiduMobStat.onEvent(e.name,"pass")},bdEvt_ChangeCity:function(){this.baiduEvent(o.ChangeCity)},bdEvt_ChangePlaceClass:function(){this.baiduEvent(o.ChangePlaceClass)},bdEvt_PlaceListPaging:function(){this.baiduEvent(o.PlaceListPaging)},bdEvt_NearPlaceListPaging:function(){this.baiduEvent(o.NearPlaceListPaging)},bdEvt_Favorite:function(){this.baiduEvent(o.Favorite)},bdEvt_Suggestion:function(){this.baiduEvent(o.Suggestion)}};return new e.Class(t,u)}),define("TravelTypeStore",["MsCore","MsStore"],function(e,t){"use strict";var n={__propertys__:function(){this.key="TRAVEL_TYPE",this.cacheTime="1H",this.defaultData={}},initialize:function($super,e){$super(e)}};return new e.Class(t,n)}),define("TravelTypeModel",["MsCore","NttTravelBaseModel","TravelTypeStore"],function(e,t,n){"use strict";var r={__propertys__:function($super){$super(),this.path="/GetTravelType",this.useCache=!0,this.result=n.getInstance()},initialize:function($super,e){$super(e)}};return new e.Class(t,r)}),define("PlaceListBaseController",["MsCore","NttTravelBaseController","TravelTypeModel","TravelTypeStore"],function(e,t,n,r){"use strict";var i=n.getInstance(),s=r.getInstance(),o={initialize:function($super,e){$super(e),this._currentType2="",this._currentType2Name="",this.secondType="",this.secondTypeName="",this.menuClass={},this._currentScenicClassId="T001",this._pageIndex=1,this.selectedType={type:"T001",type2:"",type3:""}},onHide:function($super){$super()},onDispose:function($super){$super()},bindMainClassEvent:function(){var e=this;this.root.find(".list-retrieval").on("click","a.main_class_menu",function(t){var n=$(t.currentTarget).data("classid"),r=$(document.body).height()-44-50-50-5,i="T001";n=="T001"&&(i="T002"),e.root.find("#menu_class_"+i).hide(),e.menuClass[i]=!1;var s=e.selectedType.type==n;e.selectedType.type=n;if(n=="T002"){if(s)return;e.bdEvt_ChangePlaceClass(),e._currentType2="",e._currentType2Name="",e.secondType="",e.secondTypeName="",e.menuClass={},e._currentScenicClassId="T002",e._pageIndex=1,e.selectedType={type:"T002",type2:"",type3:""},e.root.find(".list-retrieval").find("a.T001").find("span.className").html("饮食");var o="#menu_class_T001 .classMenuT001_Left",u="#menu_class_T001 .classMenuT001_Right";e.root.find(o).find("a").removeClass("active"),e.root.find(u).find("a").removeClass("active"),e.root.find(u).find("a").remove(),e.root.find(".list-retrieval li").removeClass("active"),$(t.currentTarget).parent().addClass("active"),e._currentScenicClassId=n,e.root.find(".list-retrieval").find("a."+(n=="T001"?"T002":"T001")).find(".iconfont").removeClass("icon-up").addClass("icon-down"),e._pageIndex=1,e.query();return}if(!s){e.bdEvt_ChangePlaceClass(),e.root.find(".list-retrieval li").removeClass("active"),$(t.currentTarget).parent().addClass("active"),e._currentScenicClassId=n,e.root.find(".list-retrieval").find("a."+(n=="T001"?"T002":"T001")).find(".iconfont").removeClass("icon-up").addClass("icon-down"),e._pageIndex=1,e.query();return}e.menuClass[n]?(e.menuClass[n]=!1,e.root.find("#menu_class_"+n).hide(),e.root.css({"overflow-y":"",height:""}),e.scrollTop=$(document.body).scrollTop(e.scrollTop),e.root.find(".list-retrieval").find("a."+n).find(".iconfont").removeClass("icon-up").addClass("icon-down")):(e.menuClass[n]=!0,e.root.find("#menu_class_"+n).show(),e.root.find("#menu_class_"+n).css("height",r),e.root.find("#menu_class_"+n).find("div.sort_list_box").css("height",r),e.scrollTop=$(document.body).scrollTop(),e.root.css({"overflow-y":"hidden",height:$(document.body).height()}),e.root.find(".list-retrieval").find("a."+n).find(".iconfont").removeClass("icon-down").addClass("icon-up")),e.root.find(".list-retrieval li").removeClass("active"),$(t.currentTarget).parent().addClass("active")})},loadClassMenu:function(){var e=this;i.param={},i.execute({onSuccess:function(t){console.log(t),e.createClassMenu(t)},onError:function(e){}})},createClassMenu:function(e){var t=this,n=[],r=[];n.push('<a href="#" data-type="0">全部</a>'),r.push('<a href="#" data-type="0">全部</a>');for(var i=0,s=e.length;i<s;i++){var o=e[i];o.parent_id=="T001"?n.push('<a href="#" data-type="'+o.type_id+'" data-typename="'+o.type_name+'">'+o.type_name+"</a>"):o.parent_id=="T002"&&r.push('<a href="#" data-type="'+o.type_id+'" data-typename="'+o.type_name+'">'+o.type_name+"</a>")}this.root.find("#menu_class_T001 .classMenuT001_Left").html(n.join("")),this.root.find("#menu_class_T002 .classMenuT002_Left").html(r.join("")),this.bindMiddleMenuClassEvent("T001",e),this.bindMiddleMenuClassEvent("T002",e)},bindMiddleMenuClassEvent:function(e,t){var n=this,r="#menu_class_"+e+" .classMenu"+e+"_Left",i="#menu_class_"+e+" .classMenu"+e+"_Right";this.root.find(r).on("click","a",function(s){var o=$(s.currentTarget).data("type"),u=$(s.currentTarget).data("typename");n._currentScenicClassId=e,n.root.find(r).find("a").removeClass("active"),$(s.currentTarget).addClass("active"),n.secondType=o,n.secondTypeName=u,n.selectedType.type2=o;if(o==""&&o=="0")n._currentType2="",n._currentType2Name="",n.root.find(i).html(""),n.classMenuChange(e);else{var a=[];a.push('<a href="#" data-type="" class="ui-link" data-typename="">全部</a>');for(var f=0,l=t.length;f<l;f++){var c=t[f];c.parent_id==o&&a.push('<a href="#" class="ui-link"  data-type="'+c.type_id+'" data-typename="'+c.type_name+'">'+c.type_name+"</a>")}var h=$(document.body).height()-44-50-50-5;console.log(h);var p=parseInt(h/40)+1,d=a.length;if(d<p){var v=p-d;for(var f=0,l=v;f<l;f++)a.push("<a></a>")}n.root.find(i).html(a.join("")),n.root.find(i).find("a").css("height",40)}}),n.root.find(i).on("click","a",function(t){n.root.find(i).find("a").removeClass("active"),$(t.currentTarget).addClass("active");var r=$(t.currentTarget).data("type"),s=$(t.currentTarget).data("typename");n.selectedType.type3=r,r!=""&&r!="0"?(n._currentType2=r,n._currentType2Name=s):(n._currentType2=n.secondType,n._currentType2Name=n.secondTypeName),n.classMenuChange(e)})},classMenuChange:function(e){this._currentType2==""?this.root.find(".list-retrieval").find("a."+e).find("span.className").html(e=="T001"?"饮食":"酒店"):this.root.find(".list-retrieval").find("a."+e).find("span.className").html(this._currentType2Name),this.root.find(".list-retrieval").find("a."+e).find(".iconfont").removeClass("icon-up").addClass("icon-down"),e=e=="T001"?"T002":"T001";var t=e=="T001"?"饮食":"酒店";this.root.find(".list-retrieval").find("a."+e).find("span.className").html(t);var n="#menu_class_"+e+" .classMenu"+e+"_Left",r="#menu_class_"+e+" .classMenu"+e+"_Right";this.root.find(n).find("a").removeClass("active"),this.root.find(r).find("a").removeClass("active"),this.root.find("#menu_class_T001").hide(),this.root.find("#menu_class_T002").hide(),this.menuClass.T001=!1,this.menuClass.T002=!1,this.root.css({"overflow-y":"",height:""}),this._pageIndex=1,this.bdEvt_ChangePlaceClass(),this.query()},onShow:function($super){$super(),this._currentType2="",this._currentType2Name="",this.secondType="",this.secondTypeName="",this.menuClass={},this._currentScenicClassId="T001",this._pageIndex=1,this.selectedType={type:"T001",type2:"",type3:""}},onBeforeShow:function($super){$super(),this.root.find(".list-retrieval").find("a.T001").find("span.className").html("饮食"),this.root.find(".list-retrieval").find("a.T002").find("span.className").html("酒店"),this.root.find(".list-retrieval").find("a.T001").find(".iconfont").removeClass("icon-up").addClass("icon-down"),this.root.find(".list-retrieval").find("a.T002").find(".iconfont").removeClass("icon-up").addClass("icon-down");var e=["T001","T002"];for(var t=0,n=e.length;t<n;t++){var r="#menu_class_"+e[t]+" .classMenu"+e[t]+"_Left",i="#menu_class_"+e[t]+" .classMenu"+e[t]+"_Right";this.root.find(r).find("a").removeClass("active"),this.root.find(i).find("a").removeClass("active"),this.root.find(i).find("a").remove(),$(this.root.find(".list-retrieval").find("li")[0]).removeClass("active").addClass("active"),$(this.root.find(".list-retrieval").find("li")[1]).removeClass("active"),this.root.find("#menu_class_"+e[t]).hide()}this.root.css({"overflow-y":"",height:""}),this.scrollTop=$(document.body).scrollTop(self.scrollTop)}};return new e.Class(t,o)}),define("NttNavWidget",[],function(){"use strict";var e={bindHeader:function(e){var t=this;e.root.find(".header-setup").on("tap",function(){e.jump("UserSetting")})},hideMenu:function(e){},bindFooter:function(e,t){e.root.find(".footer-box ul").on("tap","li",function(n){var r=$(n.currentTarget).data("url"),i=$(n.currentTarget).data("url-type");if(r===t)return;e.jump(r)})}};return e}),define("NttShareWidget",[],function(){"use strict";var e={share:function(e,t){}};return e}),define("MsImageSliderWidget",[],function(){"use strict";var e={bind:function(e){this.opts=e,this.container=this.opts.scope.root.find(this.opts.node),this.nocontainer=this.opts.scope.root.find(this.opts.sortNode),this.run()},run:function(){this.init(),this.imageIndex=0,this.width=0,this.height=0,this.calcImage,this.isChanging=!1,this.left=0,this.current=null,this.dir="",this.auto=!0,this.autoPlayTimeout=null,this.autoPlay()},init:function(){this.registerSwipe(),this.setContainerSize(),$(window).on("resize",$.proxy(this.setContainerSize,this)),this.container.css({left:0});var e=this;this.container.on("tap","div.image_sldier_item",function(t){var n=$(t.currentTarget).data("index");e.opts.clickCallback.call(e.opts.scope,e.opts.imgs[n])}),this.container.get()[0].addEventListener(this.getBroswerPre()+"TransitionEnd",function(){e.tansitionEnd(),e.autoPlay()},!1)},tansitionEnd:function(){this.isChanging=!1,this.isTranlating=!1,this.container.removeClass("slider_animate"),this.dir=="L"?this.current=$(this.container.find(".image_sldier_item")[2]):this.current=$(this.container.find(".image_sldier_item")[0]),this.imageIndex=this.current.data("index"),this.nocontainer.find("li").removeClass("on"),$(this.nocontainer.find("li")[this.imageIndex]).addClass("on"),this.readyToChange(),this.container.css({left:-this.width})},readyToChange:function(){var e=this.current.prev(),t=this.current.next(),n=0;while(e&&n<=2)e.remove(),e=this.current.prev(),n++;n=0;while(t&&n<=2)t.remove(),t=this.current.next(),n++;if(this.imgHtmls.length<=1)return;var r=0,i=0;this.imageIndex==0?(i=this.imgHtmls.length-1,r=1):this.imageIndex==this.imgHtmls.length-1?(i=this.imageIndex-1,r=0):(i=this.imageIndex-1,r=this.imageIndex+1),this.current.after(this.imgHtmls[r]).before(this.imgHtmls[i]),this.current.prev().css({width:this.width,height:this.height}),this.current.next().css({width:this.width,height:this.height})},getBroswerPre:function(){var e={},t=navigator.userAgent.toLowerCase(),n;(n=t.match(/msie ([\d.]+)/))?e.ie=n[1]:(n=t.match(/firefox\/([\d.]+)/))?e.firefox=n[1]:(n=t.match(/chrome\/([\d.]+)/))?e.chrome=n[1]:(n=t.match(/opera.([\d.]+)/))?e.opera=n[1]:(n=t.match(/version\/([\d.]+).*safari/))?e.safari=n[1]:0,(n=t.indexOf("webkit")>-1)?e.webkit=!0:!1;if(e.ie)return"";if(e.firefox)return"moz";if(e.chrome)return"webkit";if(e.opera)return"o";if(e.safari)return"webkit";if(e.webkit)return"webkit"},injectHtml:function(){this.imgHtmls=[];var e=[];for(var t=0,n=this.opts.imgs.length;t<n;t+=1)this.imgHtmls.push(this.createSliderItem(this.opts.imgs[t],t)),e.push(this.createSliderNoItem());this.container.empty(),this.current=$(this.imgHtmls[0]),this.container.append(this.current),this.imgHtmls.length>1&&(this.current.after(this.imgHtmls[1]).css({width:this.width,height:this.height}),this.current.before(this.imgHtmls[this.imgHtmls.length-1]).css({width:this.width,height:this.height})),this.nocontainer.empty(),this.nocontainer.append(e.join(""))},registerSwipe:function(){this.swipe({node:this.opts.node,leftCallback:this.leftCallback,rightCallback:this.rightCallback,scope:this})},leftCallback:function(){this.change(-1)},rightCallback:function(){this.change(1)},change:function(e){if(this.isChanging)return;var t=0;e>0?(this.dir="R",t=0):(this.dir="L",t=-this.width*2),clearTimeout(this.autoPlayTimeout),this.container.addClass("slider_animate"),this.isTranlating=!0,this.container.css({left:t})},stop:function(){clearTimeout(this.autoPlayTimeout),this.isTranlating&&this.tansitionEnd()},restart:function(){this.isChanging=!1,this.autoPlay()},setContainerSize:function(){this.calcImage&&this.calcImage.isSuccess?(this.width=Math.ceil($(window).width()),this.height=Math.ceil(this.calcImage.height*(this.width/this.calcImage.width)),this.injectHtml(),this.render()):this.loadImage(0,$.proxy(function(){this.setContainerSize()},this))},render:function(){this.container.css({left:-this.width}),this.container.parent()&&this.container.parent().css({height:this.height}),this.container.css({width:this.opts.imgs.length*this.width,height:this.height}),this.container.find(".image_sldier_item").css({width:this.width,height:this.height}),this.nocontainer.find("li").removeClass("on"),$(this.nocontainer.find("li")[0]).addClass("on");var e=$(window).width();this.nocontainer.css({width:this.opts.imgs.length*16});var t=this.nocontainer.width();this.nocontainer.parent().css({left:(e-t)/2})},loadImage:function(e,t){if(this.opts.imgs.length<=0||e>this.opts.imgs.length)return;var n=this;this.calcImage=new Image,this.calcImage.src=this.opts.imgs[e].imgUrl,this.calcImage.onload=function(){n.calcImage.isSuccess=!0,t&&t()},this.calcImage.onerror=function(){n.loadImage(++e,t)}},createSliderItem:function(e,t){return'<div class="image_sldier_item" data-index="'+t+'"><img src="'+e.imgUrl+'"></div>'},createSliderNoItem:function(){return"<li></li>"},autoPlay:function(){var e=this;this.auto&&(this.autoPlayTimeout=setTimeout(function(){e.change(-1)},3e3))},swipe:function(e){this.startPostion={x:0,y:0},this.swipeOpts=e,$(this.swipeOpts.node).on("touchmove",$.proxy(this.touchMove,this)),$(this.swipeOpts.node).on("touchstart",$.proxy(this.touchStart,this)),$(this.swipeOpts.node).on("touchend",$.proxy(this.touchEnd,this))},touchMove:function(e){e.preventDefault();var t=50,n=(e.originalEvent||e).touches[0],r={x:n.pageX,y:n.pageY},i=r.x-this.startPostion.x;i>0&&i>t?this.swipeRight():i<0&&Math.abs(i)>t&&this.swipeLeft()},touchStart:function(e){e.preventDefault();var t=(e.originalEvent||e).touches[0];this.startPostion={x:t.pageX,y:t.pageY}},touchEnd:function(e){e.preventDefault()},swipeLeft:function(){this.swipeOpts.leftCallback.call(this.swipeOpts.scope)},swipeRight:function(){this.swipeOpts.rightCallback.call(this.swipeOpts.scope)}};return e}),define("ClickFavoriteModel",["MsCore","NttTravelBaseModel"],function(e,t,n){"use strict";var r={__propertys__:function($super){$super(),this.path="/ClickFavorite"},initialize:function($super,e){$super(e)}};return new e.Class(t,r)}),define("FavoriteStore",["MsCore","MsStore","ClickFavoriteModel"],function(e,t,n){"use strict";var r={__propertys__:function(){this.key="FAVORITE_ITEM",this.cacheTime="9999D",this.defaultData={},this._clickFavoriteModel=n.getInstance()},initialize:function($super,e){$super(e)},add:function(e){if(!("place_id"in e))return;this._clickFavoriteModel.param={type:e.type,type2:"type2"in e?e.type2:"",url:e.place_link,udid:""},this._clickFavoriteModel.execute({onSuccess:function(){},onError:function(){}}),e.place_link=e.place_link.replace(/site%3d[\s\S]*%26plan/ig,"site%3d90000%26");var t=this.getValue();t==null?(t={},t[e.place_id]=e):e.place_id in t||(t[e.place_id]=e),this.setValue(t)},contains:function(e){if("place_id"in e){var t=this.getValue();return t==null?!1:e.place_id in t?!0:!1}return!0},remove:function(e){var t=this.getValue();t!=null&&e in t&&(delete t[e],this.setValue(t))}};return new e.Class(t,r)}),define("IndexHotCityStore",["MsCore","MsStore"],function(e,t){"use strict";var n={__propertys__:function(){this.key="HOT_CITY_LIST",this.cacheTime="1H",this.defaultData={}},initialize:function($super,e){$super(e)}};return new e.Class(t,n)}),define("IndexBannerStore",["MsCore","MsStore"],function(e,t){"use strict";var n={__propertys__:function(){this.key="INDEX_BANNER",this.cacheTime="1D",this.defaultData={}},initialize:function($super,e){$super(e)}};return new e.Class(t,n)}),define("text",["module"],function(e){"use strict";var t,n,r,i,s,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],u=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,a=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,f=typeof location!="undefined"&&location.href,l=f&&location.protocol&&location.protocol.replace(/\:/,""),c=f&&location.hostname,h=f&&(location.port||undefined),p={},d=e.config&&e.config()||{};t={version:"2.0.12",strip:function(e){if(e){e=e.replace(u,"");var t=e.match(a);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:d.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=o[t];try{e=new ActiveXObject(n)}catch(r){}if(e){o=[n];break}}return e},parseName:function(e){var t,n,r,i=!1,s=e.indexOf("."),o=e.indexOf("./")===0||e.indexOf("../")===0;return s!==-1&&(!o||s>1)?(t=e.substring(0,s),n=e.substring(s+1,e.length)):t=e,r=n||t,s=r.indexOf("!"),s!==-1&&(i=r.substring(s+1)==="strip",r=r.substring(0,s),n?n=r:t=r),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,d.isBuild&&(p[e]=r),i(r)},load:function(e,n,r,i){if(i&&i.isBuild&&!i.inlineText){r();return}d.isBuild=i&&i.isBuild;var s=t.parseName(e),o=s.moduleName+(s.ext?"."+s.ext:""),u=n.toUrl(o),a=d.useXhr||t.useXhr;if(u.indexOf("empty:")===0){r();return}!f||a(u,l,c,h)?t.get(u,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([o],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(p.hasOwnProperty(n)){var s=t.jsEscape(p[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.ext?"."+o.ext:"",a=o.moduleName+u,f=r.toUrl(o.moduleName+u)+".js";t.load(a,r,function(n){var r=function(e){return i(f,e)};r.asModule=function(e,t){return i.asModule(e,f,t)},t.write(e,a,r,s)},s)}};if(d.env==="node"||!d.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node&&!process.versions["node-webkit"])n=require.nodeRequire("fs"),t.get=function(e,t,r){try{var i=n.readFileSync(e,"utf8");i.indexOf("﻿")===0&&(i=i.substring(1)),t(i)}catch(s){r&&r(s)}};else if(d.env==="xhr"||!d.env&&t.createXhr())t.get=function(e,n,r,i){var s=t.createXhr(),o;s.open("GET",e,!0);if(i)for(o in i)i.hasOwnProperty(o)&&s.setRequestHeader(o.toLowerCase(),i[o]);d.onXhr&&d.onXhr(s,e),s.onreadystatechange=function(t){var i,o;s.readyState===4&&(i=s.status||0,i>399&&i<600?(o=new Error(e+" HTTP status: "+i),o.xhr=s,r&&r(o)):n(s.responseText),d.onXhrComplete&&d.onXhrComplete(s,e))},s.send(null)};else if(d.env==="rhino"||!d.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),r!==null&&n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};else if(d.env==="xpconnect"||!d.env&&typeof Components!="undefined"&&Components.classes&&Components.interfaces)r=Components.classes,i=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),s="@mozilla.org/windows-registry-key;1"in r,t.get=function(e,t){var n,o,u,a={};s&&(e=e.replace(/\//g,"\\")),u=new FileUtils.File(e);try{n=r["@mozilla.org/network/file-input-stream;1"].createInstance(i.nsIFileInputStream),n.init(u,1,0,!1),o=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(i.nsIConverterInputStream),o.init(n,"utf-8",n.available(),i.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),o.readString(n.available(),a),o.close(),n.close(),t(a.value)}catch(f){throw new Error((u&&u.path||"")+": "+f)}};return t}),define("text!IndexViewHtml",[],function(){return'<div data-role="page" id="IndexView" data-cache="true">\r\n\r\n    <div data-role="header" role="banner" data-position="fixed" data-tap-toggle="false" class="ms-header">\r\n        <div class="head-box">\r\n            <span class="header-title" style="text-align: left; padding-left: 10px;">\r\n                <img src="src/res/image/abuout-logo.png" />\r\n            </span>\r\n            <span class="header-setup"><i class="iconfont icon-fenleihuaban"></i></span>\r\n        </div>\r\n    </div>\r\n    <div data-role="content" class="ms-content">\r\n            <div class="index_agreement" style="line-height: 18px">\r\n              \r\n                <div id="agreementContent"></div>\r\n\r\n                <button class="btn btnAgree" data-role="none" style="display:none">同意</button>\r\n\r\n            </div>\r\n\r\n            <div class="content" style="padding: 0px 0px 10px 0px;">\r\n                <div class="index_banner" id="index_banner">\r\n                    <div class="bd"  >\r\n                        <div class="image_slider_container" id="sliderContainer" style="width: 3000px">\r\n                        </div>\r\n                    </div>\r\n                    <div class="hd">\r\n                        <ul class="imgage_slider_no">\r\n                            <li class="on"></li>\r\n                            <li class="off"></li>\r\n                            <li class="off"></li>\r\n                            <li class="off"></li>\r\n                            <li class="off"></li>\r\n                        </ul>\r\n                    </div>\r\n                </div>\r\n                <div class="index_mod">\r\n                    <h2 class="index_mod_title">热门城市</h2>\r\n                    <div class="index_mod_body">\r\n                        <ul class="hot_rec">\r\n                        </ul>\r\n                    </div>\r\n                </div>\r\n                <div class="index_mod mt_10">\r\n                    <h2 class="index_mod_title">从地图选择</h2>\r\n\r\n                    <div class="index_mod_body">\r\n                        <div class="index_mod_map">\r\n                           <!-- <div class="mod_map_box mod_map_01">-->\r\n                              <!--  <a class="sapporo city"  style="font-size:12px;line-height: 15px;padding-top: 3px;width: 35px;height: 35px;"  data-cityid="R0001" data-cityname="北海道"> 北<br />海道</a></div>-->\r\n                            <div class="mod_map_box mod_map_01"><a class="sapporo ui-link city" data-cityid="R001" data-cityname="北海道">北海道</a></div>\r\n                            <div class="mod_map_box mod_map_02"><a class="sendai ui-link city" data-cityid="R009" data-cityname="仙台">仙台</a></div>\r\n                            <div class="mod_map_box mod_map_03">\r\n                                <span class="fuji"  style="width:20px">\r\n                                    <!--<img src="src/res/image/mapphoto_02.jpg" >--></span>\r\n                                <a class="hakone ui-link city" data-cityid="R036" data-cityname="箱根">箱根</a>\r\n                                <a class="yokohama ui-link city" data-cityid="R034" data-cityname="横滨">横滨</a>\r\n                                <a class="tokyo ui-link city" data-cityid="R020" data-cityname="东京">东京</a>\r\n                            </div>\r\n                            <div class="mod_map_box mod_map_04">\r\n                                <a class="kobe ui-link city" data-cityid="R051" data-cityname="神户">神户</a>\r\n                                <a class="kyoto ui-link city" data-cityid="R049" data-cityname="京都">京都</a>\r\n                                <a class="osaka ui-link city" data-cityid="R050" data-cityname="大阪">大阪</a>\r\n                                <a class="nara ui-link city" data-cityid="R052" data-cityname="奈良">奈良</a>\r\n                            </div>\r\n                            <div class="mod_map_box mod_map_05"><a class="hiroshima ui-link city" data-cityid="R057" data-cityname="广岛">广岛</a></div>\r\n                            <div class="mod_map_box mod_map_06"><a class="kagawa ui-link city" data-cityid="R060" data-cityname="香川">香川</a></div>\r\n                            <div class="mod_map_box mod_map_07"><a class="bodo ui-link city" data-cityid="R063" data-cityname="博多">博多</a></div>\r\n                           <!-- <span class="kyoto_photo"><img src="img/index/mapphoto_01.jpg"/></span>-->\r\n                            <div class="okinawa"><a class="okinawa ui-link city" data-cityid="R070" data-cityname="冲绳">冲绳</a> </div>\r\n                            <a class="othercity ui-link" href="#CityList">其它城市</a>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n    </div>\r\n    <div data-role="footer" data-position="fixed" class="ms-footer" data-tap-toggle="false">\r\n        <div class="footer-box">\r\n            <ul>\r\n                <li data-url="Index" class="active" data-url-type="app"><a><i class="iconfont icon-shouye"></i><span>首页</span></a></li>\r\n                <li data-url="RecommendList" data-url-type="web"><a><i class="iconfont icon-tuijiankehu"></i><span>推荐</span></a></li>\r\n                <li data-url="NearList" data-url-type="web"><a><i class="iconfont icon-zhoubianyou"></i><span>周边</span></a></li>\r\n                <li data-url="FavoriteList" data-url-type="web"><a><i class="iconfont icon-shoucangcc"></i><span>收藏</span></a></li>\r\n            </ul>\r\n        </div>\r\n    </div>\r\n\r\n<!--    <div class="setup-pop">\r\n        <a data-link="UserSetting">设置<i class="iconfont icon-shezhi"></i></a>\r\n        <a>WIFI<i class="iconfont icon-wifi"></i></a>\r\n        <a data-link="AboutUs">关于我们</a>\r\n        <a data-link="UserAgreement">利用规则</a>\r\n    </div>-->\r\n</div>\r\n\r\n'}),define("IndexBannerModel",["MsCore","NttTravelBaseModel","IndexBannerStore"],function(e,t,n){"use strict";var r={__propertys__:function($super){$super(),this.path="/GetEventList"},initialize:function($super,e){$super(e)}};return new e.Class(t,r)}),define("IndexHotCityModel",["MsCore","NttTravelBaseModel","IndexHotCityStore"],function(e,t,n){"use strict";var r={__propertys__:function($super){$super(),this.path="/GetHotList"},initialize:function($super,e){$super(e)}};return new e.Class(t,r)}),define("ScenicDetailStore",["MsCore","MsStore"],function(e,t){"use strict";var n={__propertys__:function(){this.key="SCENIC_DETAIL",this.cacheTime="1D",this.defaultData={}},initialize:function($super,e){$super(e)}};return new e.Class(t,n)}),define("UserAgreementStore",["MsCore","MsStore"],function(e,t){"use strict";var n={__propertys__:function(){this.key="USER_AGREEMENT",this.cacheTime="999D",this.defaultData={}},initialize:function($super,e){$super(e)}};return new e.Class(t,n)}),define("CityListStore",["MsCore","MsStore"],function(e,t){"use strict";var n={__propertys__:function(){this.key="CITY_LIST",this.cacheTime="1D",this.defaultData={}},initialize:function($super,e){$super(e)}};return new e.Class(t,n)}),define("UserAgreementModel",["MsCore","NttTravelBaseModel","CityListStore"],function(e,t,n){"use strict";var r={__propertys__:function($super){$super(),this.path="/GetRule"},initialize:function($super,e){$super(e)}};return new e.Class(t,r)}),define("IndexController",["MsCore","NttTravelBaseController","text!IndexViewHtml","NttNavWidget","IndexBannerModel","IndexHotCityModel","MsImageSliderWidget","ScenicDetailStore","UserAgreementStore","UserAgreementModel","FavoriteStore"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";var c=i.getInstance(),h=s.getInstance(),p=u.getInstance(),d=a.getInstance(),v=f.getInstance(),m=l.getInstance(),g={initialize:function($super,e){$super(e),this.injectHTML(n)},onCreate:function(){this.initData(),this.pageName="index",this.checkAgreement()},initData:function(){var e=this;e.root.off("click"),e.root.find(".index_agreement").css({top:"",position:""}),e.root.find(".agreementContentMsg").css({"font-size":""}),window.MsJsBridge.init({favStore:m,detailStore:p}),r.bindHeader(this),r.bindFooter(this),this.bindHotCity(),this.root.find(".image_slider_container").parent().css({height:227*$(window).width()/640}),c.param={},c.execute({onSuccess:function(t){if(t==null||t.length<=0){e.root.find(".image_slider_container").parent().hide();return}var n=[];for(var r=0,i=t.length;r<i;r+=1){var s=t[r];n.push({imgUrl:s.img,imgId:s.event_id,imgName:s.event_name,link:s.url})}try{o.bind({node:".image_slider_container",sortNode:".imgage_slider_no",imgs:n,scope:e,clickCallback:function(e){p.setValue({url:e.link,name:e.imgName}),window.location.href=e.link&&(e.link.indexOf("?")>-1?e.link+"&MSRecommendFlag":e.link+"?MSRecommendFlag")}})}catch(u){}},onError:function(){}}),this.root.find(".index_mod_map").on("click","a.city",function(t){var n=$(t.currentTarget).data("cityid"),r=$(t.currentTarget).data("cityname");e.bdEvt_ChangeCity(),e.jump("ScenicList?cid="+n+"&cname="+encodeURIComponent(r))})},checkAgreement:function(){var e=this,t=d.getValue();this.hideContent();var n="";this.root.find(".btnAgree").on("click",function(){d.setValue({agree:n,date:new Date}),e.showContent()}),this.showLoading(),this.addAgreementMsg("正在获取利用规约,请稍候..."),v.execute({onSuccess:function(r){e.hideLoading(),t!=null&&"agree"in t&&r.version==t.agree?(e.removeAgreemntMsg(),e.showContent()):(e.root.find("#agreementContent").html(r.rule),n=r.version,e.root.find(".btnAgree").show())},onError:function(){e.hideLoading(),e.addAgreementMsg("网络连接失败，请点击屏幕重试"),e.root.find(".index_agreement").css({top:"50%",position:"absolute"}),e.root.find(".agreementContentMsg").css({"font-size":"18px"}),e.root.on("click",function(){e.initData(),e.checkAgreement()})}})},addAgreementMsg:function(e){this.removeAgreemntMsg(),this.root.find("#agreementContent").append('<div class="agreementContentMsg" style="width:100%;magin:0 auto;text-align:center;color:black;padding-bottom:20px">'+e+"</div>")},removeAgreemntMsg:function(){this.root.find("#agreementContent").find(".agreementContentMsg").remove()},showContent:function(){this.root.find(".index_agreement").hide(),this.root.find(".header-setup").show(),this.root.find(".ms-footer").show(),this.root.find(".content").show(),document.getElementsByTagName("body")[0].scrollTop=0},hideContent:function(){this.root.find(".index_agreement").show(),this.root.find(".header-setup").hide(),this.root.find(".ms-footer").hide(),this.root.find(".content").hide()},bindHotCity:function(){var e=$(window).width()/2-10,t=$(window).width()/2,n=160*e/286,r=this,i=this.root.find(".hot_rec");i.empty(),i.append('<li><div style="margin:0 auto;">加载中...</div></li>'),h.param={},h.execute({onSuccess:function(s){i.empty();if(s==null||s.length<=0)i.append('<li><div style="margin:0 auto;">暂无数据！</div></li>');else{var o="";for(var u=0,a=s.length;u<a;u+=2){var f="",l=s[u];f='<div class="hotcity" style="'+t+'" data-cityid="'+l.hot_id+'" data-cityname="'+l.hot_name+'"><a><img style="width:'+e+"px;height:"+n+'px" src="'+l.img+'" /><span>'+l.hot_name+"</span></a></div>",u+1<a&&(l=s[u+1],f+='<div style="width:'+t+'"  class="hotcity" data-cityid="'+l.hot_id+'" data-cityname="'+l.hot_name+'"><a><img  style="width:'+e+"px;height:"+n+'px" src="'+l.img+'" /><span>'+l.hot_name+"</span></a></div>"),o+="<li>"+f+"</li>"}i.append(o),r.root.find(".hot_rec").on("click","div.hotcity",function(e){var t=$(e.currentTarget).data("cityid"),n=$(e.currentTarget).data("cityname");r.bdEvt_ChangeCity(),r.jump("ScenicList?cid="+t+"&cname="+encodeURIComponent(n))}),$(window).resize(),setTimeout(function(){$(window).resize()},500)}},onError:function(){i.empty(),i.append('<li><div style="margin:0 auto;text-align:center;width:100%">暂无数据！</div></li>')}})},onShow:function($super){$super(),o.restart()},onHide:function($super){r.hideMenu(this),o.stop(),$super()},onDispose:function($super){$super()}};return new e.Class(t,g)}),define("text!ScenicListViewHtml",[],function(){return'<div data-role="page" id="ScenicListView" data-cache="true">\r\n\r\n\r\n    <!--Header Begin-->\r\n    <div data-role="header" role="banner" data-position="fixed" data-tap-toggle="false" class="ms-header">\r\n        <div class="head-box">\r\n            <a class="header-back" title="返回上一页"><i class="iconfont icon-zuo1"></i></a>\r\n            <span class="header-title"></span>\r\n            <span class="header-setup"><i class="iconfont icon-fenleihuaban"></i></span>\r\n        </div>\r\n    </div>\r\n    <!--Content Begin-->\r\n    <div data-role="content" class="ms-content">\r\n        <div class="content">\r\n            <div class="list">\r\n                <ul class="list-retrieval">\r\n                    <li class="active"><a data-classid="T001" class="main_class_menu T001">\r\n                        <span class="className">饮食</span> \r\n                        <span class="classIcon"><i class="iconfont icon-down"></i></span></a>\r\n                        <div class="pop_sort_list" id="menu_class_T001" style="display: none">\r\n                            <div class="sort_list_box second_layer classMenuT001_Left">\r\n                            </div>\r\n                            <div class="sort_list_box second_layer classMenuT001_Right">\r\n                            </div>\r\n                        </div>\r\n                    </li>\r\n                    <li><a data-classid="T002" class="main_class_menu T002">\r\n                        <span class="className">酒店</span> \r\n                        <span class="classIcon" style="display:none"><i class="iconfont icon-down"></i></span></a>\r\n                        <div class="pop_sort_list" id="menu_class_T002" style="display: none">\r\n                            <div class="sort_list_box second_layer classMenuT002_Left">\r\n                            </div>\r\n                            <div class="sort_list_box second_layer classMenuT002_Right">\r\n                            </div>\r\n                        </div>\r\n\r\n                    </li>\r\n                    <!--  <li data-classid="T003"><a>观光</a></li>-->\r\n                </ul>\r\n                <div class="product-list">\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n\r\n    </div>\r\n\r\n\r\n    <!--Content End-->\r\n    <div data-role="footer" data-position="fixed" class="ms-footer" data-tap-toggle="false">\r\n        <div class="footer-box">\r\n            <ul>\r\n                <li data-url="Index" data-url-type="app"><a><i class="iconfont icon-shouye"></i><span>首页</span></a></li>\r\n                <li data-url="RecommendList" data-url-type="web"><a><i class="iconfont icon-tuijiankehu"></i><span>推荐</span></a></li>\r\n                <li data-url="NearList" data-url-type="web"><a><i class="iconfont icon-zhoubianyou"></i><span>周边</span></a></li>\r\n                <li data-url="FavoriteList" data-url-type="web"><a><i class="iconfont icon-shoucangcc"></i><span>收藏</span></a></li>\r\n            </ul>\r\n        </div>\r\n    </div>\r\n\r\n    <!--    <div class="setup-pop">\r\n        <a data-link="UserSetting">设置<i class="iconfont icon-shezhi"></i></a>\r\n        <a>WIFI<i class="iconfont icon-wifi"></i></a>\r\n        <a data-link="AboutUs">关于我们</a>\r\n        <a data-link="UserAgreement">利用规则</a>\r\n    </div>-->\r\n\r\n    <div class="area-pop needsclick">\r\n        <div class="area-list">\r\n            <i class="iconfont icon-zuo" style="margin-top: -20px; display: none"></i>\r\n            <ul>\r\n            </ul>\r\n        </div>\r\n    </div>\r\n\r\n\r\n\r\n\r\n    <script type="text/template" id="scenic-template">\r\n        <div class="product-mod">\r\n            <div class="product-photo product-item"\r\n                data-placelink="<%=place_link%>"\r\n                data-placename="<%=place_name%>"\r\n                data-placeintro="<%=place_intro%>"\r\n                data-placeimg="<%=img%>"\r\n                data-placeid="<%=place_id%>"\r\n                data-placetype="<%=type%>">\r\n                <%if(img==""){%>\r\n                    <a style="padding-top: 25px;"><span style="font-size: 12px; padding-left: 8px; color: #b5b5b5;">暂无图片</span></a>\r\n                <% }else{%>\r\n                      <a>\r\n                          <img src="<%=img%>" /></a>\r\n                <%}%>\r\n                    \r\n            </div>\r\n            <div class="product-info product-item" data-placelink="<%=place_link%>"\r\n                data-placename="<%=place_name%>"\r\n                data-placeintro="<%=place_intro%>"\r\n                data-placeimg="<%=img%>"\r\n                data-placeid="<%=place_id%>"\r\n                data-placetype="<%=type%>">\r\n                <h3><a><%=place_name%></a></h3>\r\n                <p><%=place_intro%></p>\r\n            </div>\r\n            <div class="product-action">\r\n                <i class="iconfont icon-fenxiang" data-pid="<%=place_id%>"></i>\r\n                <i class="iconfont <%=favorite%> " data-pid="<%=place_id%>"></i>\r\n            </div>\r\n        </div>\r\n    </script>\r\n\r\n\r\n\r\n</div>\r\n\r\n\r\n\r\n'}),define("ScenicListModel",["MsCore","NttTravelBaseModel"],function(e,t){"use strict";var n={__propertys__:function($super){$super(),this.path="/GetPlaceList "},initialize:function($super,e){$super(e)}};return new e.Class(t,n)}),define("SubregionListModel",["MsCore","NttTravelBaseModel"],function(e,t){"use strict";var n={__propertys__:function($super){$super(),this.path="/GetRegionList"},initialize:function($super,e){$super(e)}};return new e.Class(t,n)}),define("ScenicListController",["MsCore","PlaceListBaseController","text!ScenicListViewHtml","ScenicListModel","NttNavWidget","SubregionListModel","ScenicDetailStore","NttShareWidget","FavoriteStore","MsWidgetMask","TravelTypeModel","TravelTypeStore"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";var h=f.create(),p="",d=0,v="",m={Food:"T001",Hotel:"T002",Landscape:"T003"},g=m.Food,y=1,b=10,w=0,E=r.getInstance(),S=s.getInstance(),x=o.getInstance(),T=a.getInstance(),N=!0,C={},k=!1,L={initialize:function($super,e){$super(e),this.injectHTML(n)},onCreate:function(){var e=this;this.pageName="place_list",this.isShowSubRegion=!1,this.scrollTop=0,this.loadClassMenu(),this.bindMainClassEvent(),this.root.find(".header-back").on("click",function(){e.back()}),this.selectCity={cityId:"",subCityId:"",cityName:"",subCityName:""},i.bindHeader(this),i.bindFooter(this);var t=$(document.body).width();this.root.find(".area-pop").css({left:t}).addClass("menu_class"),this.root.find(".area-list").find(".iconfont").on("click",function(n){var r=e.root.find(".area-pop").data("status");r=="S"?(e.isShowSubRegion=!1,e.root.css({"overflow-y":"",height:""}),e.scrollTop=$(document.body).scrollTop(e.scrollTop),e.root.find(".area-pop ul").hide(),e.root.find(".area-pop").data("status","H"),e.root.find(".area-pop").css({left:t}),e.root.find(".area-list").find(".iconfont").removeClass("icon-you").addClass("icon-zuo")):(e.isShowSubRegion=!0,e.scrollTop=$(document.body).scrollTop(),e.root.css({"overflow-y":"hidden",height:$(document.body).height()}),e.root.find(".area-pop ul").show(),e.root.find(".area-pop").data("status","S"),e.root.find(".area-pop").css({left:t-150}),e.root.find(".area-list").find(".iconfont").removeClass("icon-zuo").addClass("icon-you"))}),e.root.find(".area-pop i").css({top:($(window).height()-$(e.root.find(".area-pop i")).height())/2}),this.listTemplateFun=e.template(this.root.find("#scenic-template").html()),this.scroll({bottomCallback:function(){if(e.isShowSubRegion)return;e.bdEvt_PlaceListPaging(),e.query()}}),this.root.find(".area-pop ul").on("click","li",function(n){e.root.css({"overflow-y":"",height:""});var r=$(n.currentTarget).data("subreigonname");e.setContentTitle(r),w=$(n.currentTarget).data("subreigonid"),e._pageIndex=1,e.root.find(".area-pop").data("status","H"),e.root.find(".area-pop").css({left:t}),e.root.find(".area-list").find(".iconfont").removeClass("icon-you").addClass("icon-zuo"),e.isShowSubRegion=!1,e.query()}),this.root.find(".product-list").on("touchstart","div.product-item",function(e){$(e.currentTarget).parent().css({"background-color":"#fff1e6"}),setTimeout(function(){$(e.currentTarget).parent().css({"background-color":""})},600)}),this.root.find(".product-list").on("click","div.product-item",function(t){$(t.currentTarget).parent().css({"background-color":"#fff1e6"}),x.setValue(C[$(t.currentTarget).data("placeid")]),console.log(e.sotreDetailUrl(C[$(t.currentTarget).data("placeid")])),window.location.href=e.sotreDetailUrl(C[$(t.currentTarget).data("placeid")]),setTimeout(function(){$(t.currentTarget).parent().css({"background-color":""})},600)}),this.root.find(".product-list").on("click","i.icon-fenxiang",function(t){var n=$(t.currentTarget).data("pid"),r=C[n];window.MsJsBridge.showShare({title:r.place_name,content:r.place_intro,imgUrl:r.img,linkUrl:r.place_link,scope:e})}),this.root.find(".product-list").on("click","i.icon-shoucangcc",function(t){var n=$(t.currentTarget).data("pid"),r=C[n];if($(t.currentTarget).hasClass("active")){window.MsJsBridge.confirm({msg:"您确认取消收藏吗？",title:"提示",okCallback:function(){T.remove(n),$(t.currentTarget).removeClass("active")},cancelCallback:function(){},scope:e});return}try{e.bdEvt_Favorite(),T.add(r),$(t.currentTarget).addClass("active"),window.MsJsBridge.isAvailable()?MsJsBridge.showToast("收藏成功"):e.showMessage({content:"收藏成功!",delayClose:!0})}catch(i){window.MsJsBridge.isAvailable()?MsJsBridge.showToast("收藏失败"):e.showMessage({content:"收藏失败!",delayClose:!0})}})},onBeforeShow:function($super){$super();var e=this.request.cid,t=decodeURIComponent(this.request.cname);this.root.find(".product-list").empty(),this.root.find(".header-title").html(t)},onShow:function($super){$super();var e=this.request.cid,t=decodeURIComponent(this.request.cname);d=e,p=t,w=0,self._pageIndex=1,this.setContentTitle(),this.bindSubRegion(),this.query(),this.root.find(".area-pop").show(),this.root.find(".area-pop ul").hide()},onHide:function($super){var e=this.root.find(".area-pop").data("status"),t=$(document.body).width();e=="S"&&(this.root.find(".area-pop ul").hide(),this.root.find(".area-pop").data("status","H"),this.root.find(".area-pop").css({left:t}),this.root.find(".area-list").find(".iconfont").removeClass("icon-you").addClass("icon-zuo")),i.hideMenu(this),this.root.find(".area-pop").hide(),$super()},onDispose:function($super){$super()},query:function(){if(!N)return;N=!1;var e=this;this.showLoading(),this._pageIndex==1?(this.root.find(".product-list").empty(),e.appendListMsg("正在加载，请稍候...")):e.appendListMsg("正在加载更多内容，请稍候..."),E.param={city:d,region:w,type:this._currentScenicClassId,pageIndex:this._pageIndex,pageSize:b,lat:0,lng:0,type2:this._currentType2};var t=T.getValue();E.execute({onSuccess:function(n){e.hideLoading();var r="";if(n==null||n.length<=0){e._pageIndex>1?e.appendListMsg("没有了哦！"):e.appendListMsg("啊哦，暂时还没有数据呢！"),N=!0;return}for(var i=0,s=n.length;i<s;i+=1)n[i].favorite="icon-shoucangcc",t&&n[i].place_id in t&&(n[i].favorite="icon-shoucangcc active"),r+=e.listTemplateFun(n[i]),n[i].place_id in C||(C[n[i].place_id]=n[i]);e.root.find(".product-list").find(".product-loadingMsg").remove(),e.root.find(".product-list").append(r),e._pageIndex+=1;var o=setTimeout(function(){N=!0,clearTimeout(o),o=null},500)},onError:function(t){N=!0,e.hideLoading(),e.appendListMsg("啊哦，获取数据发生错误啦！")}})},bindSubRegion:function(){var e=this;e.root.find(".area-pop ul").hide(),S.param={city_id:this.request.cid},S.execute({onSuccess:function(t){e.root.find(".area-pop ul").empty();if(t==null){e.root.find(".area-list").find(".iconfont").hide();return}if("length"in t&&t.length<=0){e.root.find(".area-list").find(".iconfont").hide();return}e.root.find(".area-list").find(".iconfont").show();var n="";for(var r=0,i=t.length;r<i;r+=1)n+="<li data-subreigonid="+t[r].rgn_id+" data-subreigonname="+t[r].rgn_name+"><a>"+t[r].rgn_name+"</a></li>";e.root.find(".area-pop ul").append(n),e.root.find(".area-pop ul").css({height:$(document.body).height()-94})},onError:function(){}})},setContentTitle:function(e){var t=e?p+"-"+e:p;this.root.find(".header-title").html(t)},appendListMsg:function(e){this.root.find(".product-list").find(".product-loadingMsg").remove(),this.root.find(".product-list").append('<div class="product-mod product-loadingMsg" style="width:100%;text-align:center" ><div style="margin:0 auto;width:100%;text-align:center" >'+e+"</div></div>")}};return new e.Class(t,L)}),define("text!RecommendListViewHtml",[],function(){return'<div data-role="page" id="RecommendListView" data-cache="true">\r\n    <div data-role="header" role="banner" data-position="fixed" data-tap-toggle="false" class="ms-header">\r\n        <div class="head-box">\r\n           <!-- <a   class="header-back" title="返回上一页"><i class="iconfont icon-zuo1"></i></a>-->\r\n            <span class="header-title" style="padding-left:47px">推荐</span>\r\n            <span class="header-setup"><i class="iconfont icon-fenleihuaban"></i></span>\r\n        </div>\r\n    </div>\r\n    <div data-role="content" class="ms-content">\r\n        <div class="content-recommend">\r\n\r\n            <div class="recommend">\r\n            \r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div data-role="footer" data-position="fixed" class="ms-footer" data-tap-toggle="false">\r\n        <div class="footer-box">\r\n            <ul>\r\n                <li data-url="Index" data-url-type="app"><a><i class="iconfont icon-shouye"></i><span>首页</span></a></li>\r\n                <li class="active" data-url="RecommendList" data-url-type="web"><a><i class="iconfont icon-tuijiankehu"></i><span>推荐</span></a></li>\r\n                <li data-url="NearList" data-url-type="web"><a><i class="iconfont icon-zhoubianyou"></i><span>周边</span></a></li>\r\n                <li data-url="FavoriteList" data-url-type="web"><a><i class="iconfont icon-shoucangcc"></i><span>收藏</span></a></li>\r\n            </ul>\r\n        </div>\r\n    </div>\r\n<!--    <div class="setup-pop">\r\n        <a data-link="UserSetting">设置<i class="iconfont icon-shezhi"></i></a>\r\n        <a >WIFI<i class="iconfont icon-wifi"></i></a>\r\n        <a data-link="AboutUs">关于我们</a>\r\n        <a data-link="UserAgreement">利用规则</a>\r\n    </div>-->\r\n\r\n    <script type="text/template" id="recommend-template">\r\n        <a  data-placelink="<%=url%>" data-placename="<%=event_name%>" data-placeimg="<%=img%>">\r\n            <img src="<%=img%>" alt="<%=event_name%>" /></a>\r\n    </script>\r\n</div>\r\n'}),define("RecommendListModel",["MsCore","NttTravelBaseModel"],function(e,t){"use strict";var n={__propertys__:function($super){$super(),this.path="/GetEventList"},initialize:function($super,e){$super(e)}};return new e.Class(t,n)}),define("RecommendListController",["MsCore","NttTravelBaseController","text!RecommendListViewHtml","RecommendListModel","NttNavWidget","ScenicDetailStore"],function(e,t,n,r,i,s){"use strict";var o="",u=0,a="",f={Food:"T001",Hotel:"T002",Landscape:"T003"},l=f.Food,c=1,h=10,p=!0,d=r.getInstance(),v=s.getInstance(),m={initialize:function($super,e){$super(e),this.injectHTML(n)},onCreate:function(){var e=this;this.pageName="recommend_list",this.root.find(".header-back").on("tap",function(){e.back()}),i.bindHeader(this),i.bindFooter(this),this.listTemplateFun=e.template(this.root.find("#recommend-template").html()),this.query(),this.root.find(".recommend").on("click","a",function(e){v.setValue({url:$(e.currentTarget).data("placelink"),name:$(e.currentTarget).data("placename"),intro:"",img:$(e.currentTarget).data("placeimg")});var t=$(e.currentTarget).data("placelink");window.location.href=t.indexOf("?")>-1?t+"&MSRecommendFlag":t+"?MSRecommendFlag"})},onShow:function($super){$super()},onHide:function($super){i.hideMenu(this),$super()},onDispose:function($super){$super()},query:function(){if(!p)return;p=!1;var e=this;c==1?(this.root.find(".recommend").empty(),this.showLoading()):this.root.find(".recommend").append('<div class="product-loadingMsg" style="margin:0 auto;width:100%;text-align:center" >正在加载更多内容，请稍候...</div>'),d.param={pageIndex:c,pageSize:h},d.execute({onSuccess:function(t){e.hideLoading();var n="";for(var r=0,i=t.length;r<i;r+=1)n+=e.listTemplateFun(t[r]);e.root.find(".recommend").find(".product-loadingMsg").remove(),e.root.find(".recommend").append(n),c+=1,p=!0},onError:function(t){e.hideLoading(),this.appendListMsg("")}})},appendListMsg:function(e){this.root.find(".recommend").append('<div class="product-loadingMsg" style="margin:0 auto;width:100%;text-align:center" >'+e+"</div>")}};return new e.Class(t,m)}),define("text!ScenicDetailViewHtml",[],function(){return'<div data-role="page" id="ScenicDetailView" data-cache="true">\r\n    <div data-role="header" role="banner" data-position="fixed" data-tap-toggle="false" class="ms-header">\r\n        <div class="head-box">\r\n            <a href="#" class="header-back" title="返回上一页"><i class="iconfont icon-zuo1"></i></a>\r\n            <span class="header-title">大阪城</span>\r\n            <span class="header-setup"><i class="iconfont icon-fenleihuaban"></i></span>\r\n        </div>\r\n    </div>\r\n    <div data-role="content" class="ms-content">\r\n        <div class="content" style="padding:0px;">\r\n            <div class="list">\r\n                <!--<iframe id="detailIframe" style="width:100%;height:100%;border:0;" src="http://www.baidu.com"></iframe>-->\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div data-role="footer" data-position="fixed" class="ms-footer" data-tap-toggle="false">\r\n        <div class="footer-box">\r\n            <ul>\r\n                <li data-url="Index" data-url-type="app"><a><i class="iconfont icon-shouye"></i><span>首页</span></a></li>\r\n                <li data-url="RecommendList" data-url-type="web"><a><i class="iconfont icon-tuijiankehu"></i><span>推荐</span></a></li>\r\n                <li data-url="NearList" data-url-type="web"><a><i class="iconfont icon-zhoubianyou"></i><span>周边</span></a></li>\r\n                <li data-url="FavoriteList" data-url-type="web"><a><i class="iconfont icon-shoucangcc"></i><span>收藏</span></a></li>\r\n            </ul>\r\n        </div>\r\n    </div>\r\n\r\n    	<div class="fiexd_btn_box">\r\n            <i class="iconfont icon-fenxiang"></i>\r\n			<i class="iconfont icon-shoucangcc"></i>\r\n		</div>\r\n<!--     <div class="setup-pop">\r\n        <a data-link="UserSetting">设置<i class="iconfont icon-shezhi"></i></a>\r\n        <a >WIFI<i class="iconfont icon-wifi"></i></a>\r\n        <a data-link="AboutUs">关于我们</a>\r\n        <a data-link="UserAgreement">利用规则</a>\r\n    </div>-->\r\n</div>\r\n'}),define("ScenicDetailController",["MsCore","NttTravelBaseController","text!ScenicDetailViewHtml","NttNavWidget","ScenicDetailStore","FavoriteStore"],function(e,t,n,r,i,s){"use strict";var o=i.getInstance(),u=s.getInstance(),a={initialize:function($super,e){$super(e),this.injectHTML(n)},onCreate:function(){var e=this;this.pageName="place_detail",this.root.find(".header-back").on("click",function(){e.root.find("#detailIframe").remove(),e.root.focus(),e.root.find(".list").empty();var t=e.request.f;t?e.jump(t):e.back()}),r.bindHeader(this),r.bindFooter(this),this.root.find(".fiexd_btn_box").find(".icon-shoucangcc").on("click",function(){var t=o.getValue();console.log(t);try{var n={place_id:t.id,place_name:t.name,img:t.img,place_link:t.url,place_intro:t.intro,type:t.type};e.bdEvt_Favorite(),u.add(n),window.MsJsBridge.isAvailable()?MsJsBridge.showToast("收藏成功"):e.showMessage({content:"收藏成功!",delayClose:!0})}catch(r){window.MsJsBridge.isAvailable()?MsJsBridge.showToast("收藏失败"):e.showMessage({content:"收藏失败!",delayClose:!0})}}),this.root.find(".fiexd_btn_box").find(".icon-fenxiang").on("click",function(){var t=o.getValue();window.MsJsBridge.showShare({title:t.name,content:t.intro,imgUrl:t.img,linkUrl:t.url,scope:e})})},onBeforeShow:function($super){$super(),this.root.find(".header-title").html("")},onShow:function($super){$super();var e=this,t=this.root.find("#detailIframe");t&&t.remove(),this.root.find(".header-title").html(o.getValue().name),this.showLoading();var t=document.createElement("iframe");t.src=o.getValue().url,t.id="detailIframe",t.name="detailIframe",this.root.find(".list").get()[0].appendChild(t),e.root.find("#detailIframe").css({display:"none",height:"100%",width:"100%",border:0}),setTimeout(function(){e.root.find("#detailIframe").show(),e.hideLoading()},2e3);var n=this.request.act;n&&n=="f"?this.root.find(".fiexd_btn_box").hide():this.root.find(".fiexd_btn_box").show(),window.hideHeaderFooter?this.root.find(".list").css({height:$(window).height()}):this.root.find(".list").css({height:$(window).height()-88})},onIframeReadystatechange:function(){},onHide:function($super){this.root.find(".list").empty(),r.hideMenu(this),this.root.find("#detailIframe").remove(),$super()},onDispose:function($super){$super()}};return new e.Class(t,a)}),define("text!FavoriteListViewHtml",[],function(){return'<div data-role="page" id="FavoriteListView" data-cache="true">\r\n    <!--Header Begin-->\r\n    <div data-role="header" role="banner" data-position="fixed" data-tap-toggle="false" class="ms-header">\r\n        <div class="head-box">\r\n            <!--<a class="header-back" title="返回上一页"><i class="iconfont icon-zuo1"></i></a>-->\r\n            <span class="header-title" style="padding-left: 47px">收藏列表</span>\r\n            <span class="header-setup"><i class="iconfont icon-fenleihuaban"></i></span>\r\n        </div>\r\n    </div>\r\n    <!--Content Begin-->\r\n    <div data-role="content" class="ms-content">\r\n        <div class="content">\r\n            <div class="list">\r\n           <ul class="list-retrieval">\r\n                    <li class="active"><a data-classid="T001" class="main_class_menu T001">\r\n                        <span class="className">饮食</span> \r\n                        <span class="classIcon"><i class="iconfont icon-down"></i></span></a>\r\n                        <div class="pop_sort_list" id="menu_class_T001" style="display: none">\r\n                            <div class="sort_list_box second_layer classMenuT001_Left">\r\n                            </div>\r\n                            <div class="sort_list_box second_layer classMenuT001_Right">\r\n                            </div>\r\n                        </div>\r\n                    </li>\r\n                    <li><a data-classid="T002" class="main_class_menu T002">\r\n                        <span class="className">酒店</span> \r\n                        <span class="classIcon" style="display:none"><i class="iconfont icon-down"></i></span></a>\r\n                        <div class="pop_sort_list" id="menu_class_T002" style="display: none">\r\n                            <div class="sort_list_box second_layer classMenuT002_Left">\r\n                            </div>\r\n                            <div class="sort_list_box second_layer classMenuT002_Right">\r\n                            </div>\r\n                        </div>\r\n\r\n                    </li>\r\n                    <!--  <li data-classid="T003"><a>观光</a></li>-->\r\n                </ul>\r\n                <div class="product-list">\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n    </div>\r\n    <!--Content End-->\r\n    <div data-role="footer" data-position="fixed" class="ms-footer" data-tap-toggle="false">\r\n        <div class="footer-box">\r\n            <ul>\r\n                <li data-url="Index" data-url-type="app"><a><i class="iconfont icon-shouye"></i><span>首页</span></a></li>\r\n                <li data-url="RecommendList" data-url-type="web"><a><i class="iconfont icon-tuijiankehu"></i><span>推荐</span></a></li>\r\n                <li data-url="NearList" data-url-type="web"><a><i class="iconfont icon-zhoubianyou"></i><span>周边</span></a></li>\r\n                <li class="active" data-url="FavoriteList" data-url-type="web"><a><i class="iconfont icon-shoucangcc"></i><span>收藏</span></a></li>\r\n            </ul>\r\n        </div>\r\n    </div>\r\n\r\n    <!--       <div class="setup-pop">\r\n            <a data-link="UserSetting">设置<i class="iconfont icon-shezhi"></i></a>\r\n            <a>WIFI<i class="iconfont icon-wifi"></i></a>\r\n            <a data-link="AboutUs">关于我们</a>\r\n            <a data-link="UserAgreement">利用规则</a>\r\n        </div>-->\r\n    <!--     <div class="area-pop">\r\n            <div class="area-list">\r\n                <i class="iconfont icon-zuo" style="margin-top: -20px; display: none"></i>\r\n                <ul style="height: 385px;">\r\n                </ul>\r\n            </div>\r\n        </div>-->\r\n\r\n    <script type="text/template" id="scenic-template">\r\n        <div class="product-mod">\r\n            <div class="product-photo product-item"\r\n                data-placelink="<%=place_link%>"\r\n                data-placename="<%=place_name%>"\r\n                data-placeintro="<%=place_intro%>"\r\n                data-placeimg="<%=img%>"\r\n                data-placeid="<%=place_id%>"\r\n                data-placetype="<%=type%>">\r\n                <%if(img==""){%>\r\n                    <a style="padding-top: 25px;"><span style="font-size: 12px; padding-left: 8px; color: #b5b5b5;">暂无图片</span></a>\r\n                <% }else{%>\r\n                      <a>\r\n                          <img src="<%=img%>" /></a>\r\n                <%}%>\r\n            </div>\r\n            <div class="product-info product-item" data-placelink="<%=place_link%>"\r\n                data-placename="<%=place_name%>"\r\n                data-placeintro="<%=place_intro%>"\r\n                data-placeimg="<%=img%>"\r\n                data-placeid="<%=place_id%>"\r\n                data-placetype="<%=type%>">\r\n                <h3><a><%=place_name%></a></h3>\r\n                <p><%=place_intro%></p>\r\n            </div>\r\n            <div class="product-action">\r\n                <i class="iconfont icon-fenxiang" data-pid="<%=place_id%>"></i>\r\n                <i class="iconfont icon-shanchu" data-pid="<%=place_id%>"></i>\r\n            </div>\r\n        </div>\r\n    </script>\r\n\r\n</div>\r\n'}),define("FavoriteListModel",["MsCore","NttTravelBaseModel"],function(e,t){"use strict";var n={__propertys__:function($super){$super(),this.path="/Query/Favorite"},initialize:function($super,e){$super(e)}};return new e.Class(t,n)}),define("FavoriteListController",["MsCore","PlaceListBaseController","text!FavoriteListViewHtml","NttNavWidget","ScenicDetailStore","FavoriteListModel","SubregionListModel","FavoriteStore","TravelTypeModel"],function(e,t,n,r,i,s,o,u,a){"use strict";var f="",l=0,c="",h={Food:"T001",Hotel:"T002",Landscape:"T003"},p=h.Food,d=1,v=10,m=0,g=s.getInstance(),y=o.getInstance(),b=a.getInstance(),w=i.getInstance(),E=u.getInstance(),S=!0,x={initialize:function($super,e){$super(e),this.injectHTML(n)},onCreate:function(){var e=this;this.pageName="favorite_list",this.root.find(".header-back").on("tap",function(){e.back()}),r.bindHeader(this),r.bindFooter(this),this.loadClassMenu(),this.bindMainClassEvent(),this.listTemplateFun=this.template(this.root.find("#scenic-template").html()),this.root.find(".product-list").on("click","div.product-item",function(t){var n=E.getValue();$(t.currentTarget).parent().css({"background-color":"#fff1e6"}),w.setValue(n[$(t.currentTarget).data("placeid")]),window.location.href=e.sotreDetailUrl(n[$(t.currentTarget).data("placeid")]),setTimeout(function(){$(t.currentTarget).parent().css({"background-color":""})},600)}),this.root.find(".product-list").on("click","i.icon-fenxiang",function(t){var n=E.getValue(),r=$(t.currentTarget).data("pid"),i=n[r];window.MsJsBridge.showShare({title:i.place_name,content:i.place_intro,imgUrl:i.img,linkUrl:i.place_link,scope:e})}),this.root.find(".product-list").on("click","i.icon-shanchu",function(t){var n=E.getValue();window.MsJsBridge.confirm({msg:"您确认取消收藏吗？",title:"提示",okCallback:function(){var e=$(t.currentTarget).data("pid"),r=n[e];delete n[e],E.setValue(n),$(t.currentTarget).parent().parent().remove()},cancelCallback:function(){},scope:e})})},onShow:function($super){$super(),this.query()},onHide:function($super){r.hideMenu(this),$super()},onDispose:function($super){$super()},query:function(){var e=this;this.root.find(".product-list").empty();var t=E.getValue();if(t==null||t.length<=0){this.root.find(".product-list").append('<div class="product-mod product-noData" style="text-align:center;width:100%" ><div style="margin:0 auto;text-align:center;width:100%"  >您没有收藏的数据!</div></div>');return}var n="";for(var r in t){var i=t[r];e.isInCurrentType(i.type,i.type2,i.type3)&&(n+=e.listTemplateFun(t[r]))}n==""?e.root.find(".product-list").append('<div class="product-mod product-noData" style="text-align:center;width:100%"><div style="margin:0 auto;text-align:center;width:100%" >您没有收藏的数据!</div></div>'):(e.root.find(".product-list").find(".product-noData").remove(),e.root.find(".product-list").append(n))},isInCurrentType:function(e,t,n){return this.selectedType.type3?n==this.selectedType.type3:this.selectedType.type2?t==this.selectedType.type2:this._currentScenicClassId?e==this._currentScenicClassId:!0},bindSubRegion:function(){var e=this;y.param={cid:this.request.cid},y.execute({onSuccess:function(t){e.root.find(".area-pop ul").empty();if(t==null){e.root.find(".area-list").find(".iconfont").hide();return}if("length"in t&&t.length<=0){e.root.find(".area-list").find(".iconfont").hide();return}e.root.find(".area-list").find(".iconfont").show();var n="";for(var r=0,i=t.length;r<i;r+=1)n+="<li data-subreigonid="+t[r].rgn_id+"><a>"+t[r].rgn_name+"</a></li>";e.root.find(".area-pop ul").append(n),e.root.find(".area-pop ul").css({height:$(document.body).height()})},onError:function(){}})},onBeforeShow:function($super){$super()}};return new e.Class(t,x)}),define("text!NearListViewHtml",[],function(){return'<div data-role="page" id="NearListView" data-cache="true">\r\n    <!--Header Begin-->\r\n    <div data-role="header" role="banner" data-position="fixed" data-tap-toggle="false" class="ms-header">\r\n        <div class="head-box">\r\n            <!--<a class="header-back" title="返回上一页"><i class="iconfont icon-zuo1"></i></a>-->\r\n            <span class="header-title" style="padding-left: 47px">周边</span>\r\n            <span class="header-setup"><i class="iconfont icon-fenleihuaban"></i></span>\r\n        </div>\r\n    </div>\r\n    <!--Content Begin-->\r\n    <div data-role="content" class="ms-content">\r\n        <div class="content">\r\n            <!-- <div class="locationMsg" style="margin: 0 auto; text-align: center;">正在定位,请稍候...</div>-->\r\n            <div class="list">\r\n\r\n                <ul class="list-retrieval">\r\n                    <li class="active"><a data-classid="T001" class="main_class_menu T001">\r\n                        <span class="className">饮食</span> \r\n                        <span class="classIcon"><i class="iconfont icon-down"></i></span></a>\r\n                        <div class="pop_sort_list" id="menu_class_T001" style="display: none">\r\n                            <div class="sort_list_box second_layer classMenuT001_Left">\r\n                            </div>\r\n                            <div class="sort_list_box second_layer classMenuT001_Right">\r\n                            </div>\r\n                        </div>\r\n                    </li>\r\n                    <li><a data-classid="T002" class="main_class_menu T002">\r\n                        <span class="className">酒店</span> \r\n                        <span class="classIcon" style="display:none"><i class="iconfont icon-down"></i></span></a>\r\n                        <div class="pop_sort_list" id="menu_class_T002" style="display: none">\r\n                            <div class="sort_list_box second_layer classMenuT002_Left">\r\n                            </div>\r\n                            <div class="sort_list_box second_layer classMenuT002_Right">\r\n                            </div>\r\n                        </div>\r\n\r\n                    </li>\r\n                    <!--  <li data-classid="T003"><a>观光</a></li>-->\r\n                </ul>\r\n                <div class="product-list">\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n    </div>\r\n    <!--Content End-->\r\n    <div data-role="footer" data-position="fixed" class="ms-footer" data-tap-toggle="false">\r\n        <div class="footer-box">\r\n            <ul>\r\n                <li data-url="Index" data-url-type="app"><a><i class="iconfont icon-shouye"></i><span>首页</span></a></li>\r\n                <li data-url="RecommendList" data-url-type="web"><a><i class="iconfont icon-tuijiankehu"></i><span>推荐</span></a></li>\r\n                <li data-url="NearList" class="active" data-url-type="web"><a><i class="iconfont icon-zhoubianyou"></i><span>周边</span></a></li>\r\n                <li data-url="FavoriteList" data-url-type="web"><a><i class="iconfont icon-shoucangcc"></i><span>收藏</span></a></li>\r\n            </ul>\r\n        </div>\r\n    </div>\r\n\r\n    <!--       <div class="setup-pop">\r\n            <a data-link="UserSetting">设置<i class="iconfont icon-shezhi"></i></a>\r\n            <a>WIFI<i class="iconfont icon-wifi"></i></a>\r\n            <a data-link="AboutUs">关于我们</a>\r\n            <a data-link="UserAgreement">利用规则</a>\r\n        </div>-->\r\n\r\n    <div class="area-pop">\r\n        <div class="area-list">\r\n            <i class="iconfont icon-zuo" style="margin-top: -20px; display: none"></i>\r\n            <ul style="height: 385px;">\r\n            </ul>\r\n        </div>\r\n    </div>\r\n\r\n    <script type="text/template" id="scenic-template">\r\n        <div class="product-mod">\r\n            <div class="product-photo product-item"\r\n                data-placelink="<%=place_link%>"\r\n                data-placename="<%=place_name%>"\r\n                data-placeintro="<%=place_intro%>"\r\n                data-placeimg="<%=img%>"\r\n                data-placeid="<%=place_id%>"\r\n                data-placetype="<%=type%>">\r\n                <%if(img==""){%>\r\n                    <a style="padding-top: 25px;"><span style="font-size: 12px; padding-left: 8px; color: #b5b5b5;">暂无图片</span></a>\r\n                <% }else{%>\r\n                      <a>\r\n                          <img src="<%=img%>" /></a>\r\n                <%}%>\r\n            </div>\r\n            <div class="product-info product-item" data-placelink="<%=place_link%>"\r\n                data-placename="<%=place_name%>"\r\n                data-placeintro="<%=place_intro%>"\r\n                data-placeimg="<%=img%>"\r\n                data-placeid="<%=place_id%>"\r\n                data-placetype="<%=type%>">\r\n                <h3><a><%=place_name%></a></h3>\r\n                <p><%=place_intro%></p>\r\n            </div>\r\n            <div class="product-action">\r\n                <i class="iconfont icon-fenxiang" data-pid="<%=place_id%>"></i>\r\n                <i class="iconfont icon-shoucangcc" data-pid="<%=place_id%>"></i>\r\n            </div>\r\n        </div>\r\n    </script>\r\n\r\n</div>\r\n'}),define("NearListModel",["MsCore","NttTravelBaseModel"],function(e,t){"use strict";var n={__propertys__:function($super){$super(),this.path="/GetPlaceList"},initialize:function($super,e){$super(e)}};return new e.Class(t,n)}),define("NearListController",["MsCore","PlaceListBaseController","text!NearListViewHtml","NearListModel","NttNavWidget","SubregionListModel","ScenicDetailStore","FavoriteStore"],function(e,t,n,r,i,s,o,u){"use strict";var a="",f=0,l="",c={Food:"T001",Hotel:"T002",Landscape:"T003"},h=c.Food,p=1,d=10,v=0,m=r.getInstance(),g=s.getInstance(),y=o.getInstance(),b=u.getInstance(),w=!0,E=0,S=0,x=!1,T={},N={initialize:function($super,e){$super(e),this.injectHTML(n)},onCreate:function(){var e=this;this.pageName="near_list",this.loadClassMenu(),this.bindMainClassEvent(),this.root.find(".header-back").on("tap",function(){e.back()}),i.bindHeader(this),i.bindFooter(this),e.scroll({bottomCallback:function(){e.bdEvt_NearPlaceListPaging(),e.query()}}),this.location();var t=$(document.body).width();this.root.find(".area-pop").css({left:t}).addClass("menu_class"),this.root.find(".area-list").find(".iconfont").on("click",function(n){var r=e.root.find(".area-pop").data("status");r=="S"?(e.root.find(".area-pop").data("status","H"),e.root.find(".area-pop").css({left:t}),e.root.find(".area-list").find(".iconfont").removeClass("icon-you").addClass("icon-zuo")):(e.root.find(".area-pop").data("status","S"),e.root.find(".area-pop").css({left:t-150}),e.root.find(".area-list").find(".iconfont").removeClass("icon-zuo").addClass("icon-you"))}),this.listTemplateFun=e.template(this.root.find("#scenic-template").html()),this.root.find(".area-pop ul").on("click","li",function(n){v=$(n.currentTarget).data("subreigonid"),e._pageIndex=1,e.root.find(".area-pop").data("status","H"),e.root.find(".area-pop").css({left:t}),e.root.find(".area-list").find(".iconfont").removeClass("icon-you").addClass("icon-zuo"),e.query()}),this.root.find(".product-list").on("click","div.product-item",function(e){$(e.currentTarget).parent().css({"background-color":"#fff1e6"}),y.setValue(T[$(e.currentTarget).data("placeid")]),window.location.href=$(e.currentTarget).data("placelink"),setTimeout(function(){$(e.currentTarget).parent().css({"background-color":""})},600)}),this.root.find(".product-list").on("click","i.icon-fenxiang",function(t){var n=$(t.currentTarget).data("pid"),r=T[n];window.MsJsBridge.showShare({title:r.place_name,content:r.place_intro,imgUrl:r.img,linkUrl:r.place_link,scope:e})}),this.root.find(".product-list").on("click","i.icon-shoucangcc",function(t){var n=$(t.currentTarget).data("pid"),r=T[n];if($(t.currentTarget).hasClass("active")){window.MsJsBridge.confirm({msg:"您确认取消收藏吗？",title:"提示",okCallback:function(){b.remove(n),$(t.currentTarget).removeClass("active")},cancelCallback:function(){},scope:e});return}try{e.bdEvt_Favorite(),b.add(r),$(t.currentTarget).addClass("active"),window.MsJsBridge.isAvailable()?MsJsBridge.showToast("收藏成功"):e.showMessage({content:"收藏成功!",delayClose:!0})}catch(i){window.MsJsBridge.isAvailable()?MsJsBridge.showToast("收藏失败"):e.showMessage({content:"收藏失败!",delayClose:!0})}})},location:function(){if(this.isLocationing)return;var e=this;this.appendListMsg("正在获取位置信息，请稍候..."),this.isLocationing=!0,window.MsJsBridge.getGeolocation({callback:function(t){this.isLocationing=!1,x=!0,E=t.lng,S=t.lat,e.root.find(".locationMsg").hide(),e.root.find(".list").show()},errorCallback:function(){x=!1,e.appendListMsg("定位失败，请打开GPS设备！")},scope:this})},onShow:function($super){$super(),f=this.request.cid,a=this.request.cname,self._pageIndex=1,this.root.find(".area-pop").show(),this.root.find(".header-title").html(a),this.maxTryCount=100,this.currentTryIndex=0,this._isLocationSuccess?this.query():(this.location(),this.locationSuccessCallback())},locationSuccessCallback:function(){x?this.query():(this.currentTryIndex++,this.currentTryIndex<100?setTimeout($.proxy(this.locationSuccessCallback,this),1e3):this.appendListMsg("定位失败，请打开GPS设备！"))},onHide:function($super){i.hideMenu(this),this.root.find(".area-pop").hide(),$super()},onDispose:function($super){$super()},query:function(){if(!w)return;if(!x)return;w=!1;var e=this;this.showLoading(),e._pageIndex==1?(this.root.find(".product-list").empty(),e.appendListMsg("正在加载，请稍候...")):e.appendListMsg("正在加载更多内容，请稍候...");var t=b.getValue();m.param={city:"",region:"",type:this._currentScenicClassId,pageIndex:e._pageIndex,pageSize:d,lat:S,lng:E,type2:this._currentType2},m.execute({onSuccess:function(n){e.hideLoading();var r="";if(n==null||n.length<=0){e._pageIndex>1?e.appendListMsg("没有了哦！"):e.appendListMsg("啊哦，暂时还没有数据呢！<br/>本功能请在日本境内使用。<br/>在日本旅行途中,请打开手机的GPS功能来搜索周边信息。"),w=!0;return}for(var i=0,s=n.length;i<s;i+=1)n[i].favorite="icon-shoucangcc",t&&n[i].place_id in t&&(n[i].favorite="icon-shoucangcc active"),n[i].place_id in T||(T[n[i].place_id]=n[i]),r+=e.listTemplateFun(n[i]);e.root.find(".product-list").find(".product-loadingMsg").remove(),e.root.find(".product-list").append(r),e._pageIndex+=1;var o=setTimeout(function(){w=!0,clearTimeout(o),o=null},500)},onError:function(t){w=!0,e.hideLoading(),e.appendListMsg("啊哦，获取数据发生错误啦！")}})},appendListMsg:function(e){this.root.find(".product-list").find(".product-loadingMsg").remove(),this.root.find(".product-list").append('<div class="product-mod product-loadingMsg" style="width:100%;text-align:center" ><div style="margin:0 auto;width:100%;text-align:center" >'+e+"</div></div>")},bindSubRegion:function(){var e=this;g.param={cid:this.request.cid},g.execute({onSuccess:function(t){e.root.find(".area-pop ul").empty();if(t==null){e.root.find(".area-list").find(".iconfont").hide();return}if("length"in t&&t.length<=0){e.root.find(".area-list").find(".iconfont").hide();return}e.root.find(".area-list").find(".iconfont").show();var n="";for(var r=0,i=t.length;r<i;r+=1)n+="<li data-subreigonid="+t[r].rgn_id+"><a>"+t[r].rgn_name+"</a></li>";e.root.find(".area-pop ul").append(n),e.root.find(".area-pop ul").css({height:$(document.body).height()})},onError:function(){}})},onBeforeShow:function($super){$super()}};return new e.Class(t,N)}),define("text!CityListViewHtml",[],function(){return'<div data-role="page" id="CityListView" data-cache="true">\r\n    <div data-role="header" role="banner" data-position="fixed" data-tap-toggle="false" class="ms-header">\r\n        <div class="head-box">\r\n            <a class="header-back" title="返回上一页"><i class="iconfont icon-zuo1"></i></a>\r\n            <span class="header-title">城市列表</span>\r\n            <span class="header-setup"><i class="iconfont icon-fenleihuaban"></i></span>\r\n        </div>\r\n    </div>\r\n    <div data-role="content" class="ms-content">\r\n        <div class="content">\r\n            <div class="list">\r\n                <div class="city-list">\r\n                    <a href="list.html">京都</a>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        \r\n    </div>\r\n    <div data-role="footer" data-position="fixed" class="ms-footer" data-tap-toggle="false">\r\n        <div class="footer-box">\r\n            <ul>\r\n                <li data-url="Index" data-url-type="app"><a><i class="iconfont icon-shouye"></i><span>首页</span></a></li>\r\n                <li data-url="RecommendList" data-url-type="web"><a><i class="iconfont icon-tuijiankehu"></i><span>推荐</span></a></li>\r\n                <li data-url="NearList" data-url-type="web"><a><i class="iconfont icon-zhoubianyou"></i><span>周边</span></a></li>\r\n                <li data-url="FavoriteList" data-url-type="web"><a><i class="iconfont icon-shoucangcc"></i><span>收藏</span></a></li>\r\n            </ul>\r\n        </div>\r\n    </div>\r\n<!--     <div class="setup-pop">\r\n        <a data-link="UserSetting">设置<i class="iconfont icon-shezhi"></i></a>\r\n        <a >WIFI<i class="iconfont icon-wifi"></i></a>\r\n        <a data-link="AboutUs">关于我们</a>\r\n        <a data-link="UserAgreement">利用规则</a>\r\n    </div>-->\r\n\r\n</div>\r\n'}),define("CityListModel",["MsCore","NttTravelBaseModel","CityListStore"],function(e,t,n){"use strict";var r={__propertys__:function($super){$super(),this.path="/GetCityList"},initialize:function($super,e){$super(e)}};return new e.Class(t,r)}),define("CityListController",["MsCore","NttTravelBaseController","text!CityListViewHtml","CityListModel","CityListStore","NttNavWidget"],function(e,t,n,r,i,s){"use strict";var o=r.getInstance(),u=i.getInstance(),a={initialize:function($super,e){$super(e),this.injectHTML(n)},onCreate:function(){var e=this;this.pageName="city_list",this.root.find(".header-back").on("tap",function(){e.back()}),s.bindHeader(this),s.bindFooter(this),o.execute({onSuccess:function(t){e.injectCityListHtml(t)},onError:function(t){e.root.find(".city-list").empty(),e.root.find(".city-list").append("<div>没有可以选择的城市!</div>")}}),this.bindSelectCity()},bindSelectCity:function(){var e=this;this.root.find(".city-list").on("click","a",function(t){var n=$(t.currentTarget).data("cityid"),r=$(t.currentTarget).data("cityname");e.bdEvt_ChangeCity(),e.jump("ScenicList?cid="+n+"&cname="+encodeURIComponent(r))})},injectCityListHtml:function(e){this.root.find(".city-list").empty(),!e&&e.length<=0&&this.root.find(".city-list").append("<a>没有可以选择的城市!</a>");var t="";for(var n=0,r=e.length;n<r;n+=1){var i=e[n];t+='<a data-cityid="'+i.city_id+'" data-cityname="'+i.city_name+'">'+i.city_name+"</a>"}this.root.find(".city-list").append(t)},onShow:function($super){$super()},onHide:function($super){s.hideMenu(this),$super()},onDispose:function($super){$super()}};return new e.Class(t,a)}),define("text!AboutUsViewHtml",[],function(){return'<div data-role="page" id="AboutUsView" data-cache="true">\r\n    <div data-role="header" role="banner" data-position="fixed" data-tap-toggle="false" class="ms-header">\r\n        <div class="head-box">\r\n            <a href="#" class="header-back" title="返回上一页"><i class="iconfont icon-zuo1"></i></a>\r\n            <span class="header-title" style="padding-right: 47px">关于优游日本</span>\r\n            <!--<span class="header-setup"><i class="iconfont icon-fenleihuaban"></i></span>-->\r\n        </div>\r\n    </div>\r\n    <div data-role="content" class="ms-content">\r\n        <div class="content-recommend">\r\n\r\n            <div class="index_agreement" style="line-height: 18px">\r\n                <div class="atitle">◆我们的APP</div>\r\n                <div class="atitle">・特集介绍</div>\r\n                <div class="acontent">\r\n                    定期推荐日本的热点旅游行程，带你领略当季最新鲜的活动。跟随我们领略春的樱花飞舞，\r\n\r\n夏的热情绽放、秋的红叶幽径、冬的温泉惬意。带给你一个全方位的日本，一个充满风土人情的行程。\r\n\r\n你，准备出发了吗？\r\n                </div>\r\n                <div class="atitle">・热门城市</div>\r\n                <div class="acontent">\r\n                    提到日本，最先跃入你脑海的是哪里呢？\r\n\r\n繁华迷离的东京、幽静和风的京都，夏日风情的冲绳，还是漫山遍野薰衣草的富良野？\r\n\r\n优游日本将一一向你介绍最具人气的热门旅游城市，提供人气美食、酒店住宿的最新情报。\r\n\r\n通过地图检索，47都道府县信息尽在APP之中。相信在收获旅途风景的同时也会拥有人生中各种难忘的体验。\r\n\r\n \r\n                </div>\r\n                <div class="atitle">・分类检索</div>\r\n                <div class="acontent">\r\n                    选择要去的城市，点击右侧的箭头，锁定检索区域，可迅速查询当地的餐饮、酒店信息,并可直接通过电话预约。\r\n\r\n喜欢的店铺，可以放到收藏夹内，\r\n\r\n以后可以随时查看，也可通过【分享】按钮和微博、微信好友共享哦。\r\n你，准备出发了吗？\r\n                </div>\r\n                <div class="atitle">・周边检索</div>\r\n                <div class="acontent">\r\n                    点击APP画面下部的【周边】菜单，通过GPS定位，推荐距离您所在位置最近的店铺。\r\n\r\n                </div>\r\n\r\n\r\n                 <div class="atitle">◆使用上的注意事项</div>\r\n                <div class="acontent">\r\n                    1）本应用软件需要在连接英特网的情况下使用，在日本境内使用本应用软件时，请确保手机通过当地的WIFI、3G等服务连接到英特网。\r\n                </div>\r\n                  <div class="acontent">\r\n                   2）从中国拨打日本的电话需要在号码前加拨+81（国际区号），在本应用软件中点击电话拨号时，应用软件将自动在号码前加拨+81使得用户可以直接拨通日本的电话号码。在日本境内使用本应用软件点击拨打电话号码时，可能因运营商不同需要使用不同的拨号方式，请与相关运营商确认具体的拨号方式。\r\n\r\n                </div>\r\n                 <div class="acontent">\r\n                   3）本应用软件内的周边功能及地图显示功能仅支持在日本境内时的使用。（中国境内不支持）\r\n                </div>\r\n\r\n<!--                <div class="atitle">◆我们的集团公司</div>\r\n                <div class="acontent">\r\n                 <a href="http://www.cn.ntt.com/sc/about-us/our-company-vision/company-information/about-ntt-communications-china.html">\r\n                     点击查看我们的集团网站\r\n                     </a>\r\n\r\n                </div>-->\r\n\r\n                <div class="acontent" style="float:right"><a href="http://ta.goo.ne.jp/area/">Ads by areamatch</a></div>\r\n\r\n            </div>\r\n\r\n        </div>\r\n    </div>\r\n    <div data-role="footer" data-position="fixed" class="ms-footer" data-tap-toggle="false">\r\n        <div class="footer-box">\r\n            <ul>\r\n                <li data-url="Index" data-url-type="app"><a><i class="iconfont icon-shouye"></i><span>首页</span></a></li>\r\n                <li data-url="RecommendList" data-url-type="web"><a><i class="iconfont icon-tuijiankehu"></i><span>推荐</span></a></li>\r\n                <li data-url="NearList" data-url-type="web"><a><i class="iconfont icon-zhoubianyou"></i><span>周边</span></a></li>\r\n                <li data-url="FavoriteList" data-url-type="web"><a><i class="iconfont icon-shoucangcc"></i><span>收藏</span></a></li>\r\n            </ul>\r\n        </div>\r\n    </div>\r\n<!--    <div class="setup-pop">\r\n        <a data-link="UserSetting">设置<i class="iconfont icon-shezhi"></i></a>\r\n        <a>WIFI<i class="iconfont icon-wifi"></i></a>\r\n        <a data-link="AboutUs">关于我们</a>\r\n        <a data-link="UserAgreement">利用规则</a>\r\n    </div>-->\r\n\r\n</div>\r\n'}),define("AboutUsController",["MsCore","NttTravelBaseController","text!AboutUsViewHtml","NttNavWidget"],function(e,t,n,r){"use strict";var i={initialize:function($super,e){$super(e),this.injectHTML(n)},onCreate:function(){var e=this;this.pageName="about_us",this.root.find(".header-back").on("tap",function(){e.back()}),r.bindHeader(this),r.bindFooter(this)},onShow:function($super){$super()},onHide:function($super){r.hideMenu(this),$super()},onDispose:function($super){$super()},query:function(){this.root.find(".product-list").empty();var e=_favoriteStore.getValue();if(e==null||e.length<=0){this.root.find(".product-list").append('<div class="product-mod product-noData" ><div style="margin:0 auto;" >您没有收藏的数据!</div></div>');return}var t="";for(var n in e){var r=e[n];r.type===_currentScenicClassId&&(t+=this.listTemplateFun(e[n]))}t==""?this.root.find(".product-list").append('<div class="product-mod product-noData" ><div style="margin:0 auto;" >您没有收藏的数据!</div></div>'):(this.root.find(".product-list").find(".product-noData").remove(),this.root.find(".product-list").append(t))},bindSubRegion:function(){var e=this;_subregionListModel.param={cid:this.request.cid},_subregionListModel.execute({onSuccess:function(t){e.root.find(".area-pop ul").empty();if(t==null){e.root.find(".area-list").find(".iconfont").hide();return}if("length"in t&&t.length<=0){e.root.find(".area-list").find(".iconfont").hide();return}e.root.find(".area-list").find(".iconfont").show();var n="";for(var r=0,i=t.length;r<i;r+=1)n+="<li data-subreigonid="+t[r].rgn_id+"><a>"+t[r].rgn_name+"</a></li>";e.root.find(".area-pop ul").append(n),e.root.find(".area-pop ul").css({height:$(document.body).height()})},onError:function(){}})}};return new e.Class(t,i)}),define("text!UserSettingViewHtml",[],function(){return'<div data-role="page" id="UserSettingView" data-cache="true">\r\n    <div data-role="header" role="banner" data-position="fixed" data-tap-toggle="false" class="ms-header">\r\n        <div class="head-box">\r\n            <a href="#" class="header-back" title="返回上一页"><i class="iconfont icon-zuo1"></i></a>\r\n            <span class="header-title"  style="padding-right:47px">设定</span>\r\n            <!--<span class="header-setup"><i class="iconfont icon-fenleihuaban"></i></span>-->\r\n        </div>\r\n    </div>\r\n    <div data-role="content" class="ms-content">\r\n        <ul class="setup_box">\r\n            <li ><a data-role="none" data-value="clearCache">清除缓存(包括收藏数据)</a><i class="iconfont icon-jiantouyou"></i></li>\r\n            <li   class="checkVersion"><a data-role="none"  data-value="appUpdate">检查新版本</a><i class="iconfont icon-jiantouyou"></i></li>\r\n            <li ><a data-role="none"  data-value="userReport">意见反馈</a><i class="iconfont icon-jiantouyou"></i></li>\r\n            <li><a data-role="none"  data-value="appShare">应用分享</a><i class="iconfont icon-jiantouyou"></i></li>\r\n<!--            <li ><a data-role="none"  data-value="recommendApp">推荐应用</a><i class="iconfont icon-jiantouyou"></i></li>-->\r\n            <li ><a data-role="none"  data-value="aboutUUtravel">关于优游日本</a><i class="iconfont icon-jiantouyou"></i></li>\r\n            <li ><a data-role="none"  data-value="appUpdateDes">版本更新信息</a><i class="iconfont icon-jiantouyou"></i></li>\r\n            <li ><a data-role="none"  data-value="userAgreement">利用规则</a><i class="iconfont icon-jiantouyou"></i></li>\r\n        </ul>\r\n    </div>\r\n    <div data-role="footer" data-position="fixed" class="ms-footer" data-tap-toggle="false">\r\n        <div class="footer-box">\r\n            <ul>\r\n                <li data-url="Index" data-url-type="app"><a><i class="iconfont icon-shouye"></i><span>首页</span></a></li>\r\n                <li data-url="RecommendList" data-url-type="web"><a><i class="iconfont icon-tuijiankehu"></i><span>推荐</span></a></li>\r\n                <li data-url="NearList" data-url-type="web"><a><i class="iconfont icon-zhoubianyou"></i><span>周边</span></a></li>\r\n                <li data-url="FavoriteList" data-url-type="web"><a><i class="iconfont icon-shoucangcc"></i><span>收藏</span></a></li>\r\n            </ul>\r\n        </div>\r\n    </div>\r\n\r\n</div>\r\n'}),define("UserSettingController",["MsCore","NttTravelBaseController","text!UserSettingViewHtml","NttNavWidget","FavoriteStore"],function(e,t,n,r,i){"use strict";var s=i.getInstance(),o={initialize:function($super,e){$super(e),this.injectHTML(n)},onCreate:function(){var e=this;this.pageName="user_setting",window.navigator.userAgent.indexOf("MsWebviewIOS")>-1&&this.root.find(".setup_box li.checkVersion").hide(),this.root.find(".header-back").on("tap",function(){e.back()}),r.bindHeader(this),r.bindFooter(this),this.bindListEvent()},onShow:function($super){$super()},onHide:function($super){r.hideMenu(this),$super()},onDispose:function($super){$super()},bindListEvent:function(){this.root.find(".setup_box").on("click","li",$.proxy(function(e){var t=$(e.target||e.currentTarget),n=t.data("value");n&&n in this&&this[n]()},this))},clearCache:function(){window.MsJsBridge.confirm({msg:"确认清除所有缓存，包括收藏数据？",title:"清除缓存",okCallback:function(){s.setValue(null),window.MsJsBridge.showToast("清除成功")},scope:this})},appUpdate:function(){var e=this;this.showLoading(),window.MsJsBridge.checkUpdate({successCallback:function(){e.hideLoading()},errorCallback:function(){e.hideLoading(),window.MsJsBridge.showToast("您的版本已经是最新版了！")}})},feedback:function(){},appShare:function(){window.MsJsBridge.showShare({title:"推荐一个原汁原味的日本旅游应用！",content:"「优游日本」手机应用旨在帮助赴日旅游的中国游客更便捷地获取源自日本的「美食」「酒店」信息！",imgUrl:"http://117.121.128.16:54322/Image/icon_60.png",linkUrl:"http://www.nttapt.com.cn",scope:this})},recommendApp:function(){this.jump("RecommendApp")},aboutUUtravel:function(){this.jump("AboutUs")},appUpdateDes:function(){this.jump("AppUpdateDes")},userAgreement:function(){this.jump("UserAgreement")},userReport:function(){this.bdEvt_Suggestion(),this.jump("UserReport")}};return new e.Class(t,o)}),define("text!UserAgreementViewHtml",[],function(){return'<div data-role="page" id="UserAgreementView" data-cache="true">\r\n    <div data-role="header" role="banner" data-position="fixed" data-tap-toggle="false" class="ms-header">\r\n        <div class="head-box">\r\n            <a href="#" class="header-back" title="返回上一页"><i class="iconfont icon-zuo1"></i></a>\r\n            <span class="header-title"  style="padding-right:47px">利用规则</span>\r\n            <!--<span class="header-setup"><i class="iconfont icon-fenleihuaban"></i></span>-->\r\n        </div>\r\n    </div>\r\n    <div data-role="content" class="ms-content">\r\n        <div class="content-recommend">\r\n            <div class="index_agreement" style="line-height: 18px">\r\n              <div id="agreementContent"></div>\r\n              <!--  <button class="btn btnAgree" data-role="none">同意</button>-->\r\n\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div data-role="footer" data-position="fixed" class="ms-footer" data-tap-toggle="false">\r\n        <div class="footer-box">\r\n            <ul>\r\n                <li data-url="Index" data-url-type="app"><a><i class="iconfont icon-shouye"></i><span>首页</span></a></li>\r\n                <li data-url="RecommendList" data-url-type="web"><a><i class="iconfont icon-tuijiankehu"></i><span>推荐</span></a></li>\r\n                <li data-url="NearList" data-url-type="web"><a><i class="iconfont icon-zhoubianyou"></i><span>周边</span></a></li>\r\n                <li data-url="FavoriteList" data-url-type="web"><a><i class="iconfont icon-shoucangcc"></i><span>收藏</span></a></li>\r\n            </ul>\r\n        </div>\r\n    </div>\r\n<!--    <div class="setup-pop">\r\n        <a data-link="UserSetting">设置<i class="iconfont icon-shezhi"></i></a>\r\n        <a >WIFI<i class="iconfont icon-wifi"></i></a>\r\n        <a data-link="AboutUs">关于我们</a>\r\n        <a data-link="UserAgreement">利用规则</a>\r\n    </div>-->\r\n\r\n</div>\r\n'}),define("UserAgreementController",["MsCore","NttTravelBaseController","text!UserAgreementViewHtml","NttNavWidget","UserAgreementModel"],function(e,t,n,r,i){"use strict";var s=i.getInstance(),o={initialize:function($super,e){$super(e),this.injectHTML(n)},onCreate:function(){var e=this;this.root.find(".header-back").on("tap",function(){e.back()}),r.bindHeader(this),r.bindFooter(this),this.pageName="user_agreement";var e=this;this.showLoading(),s.execute({onSuccess:function(t){e.hideLoading(),e.root.find("#agreementContent").html(t.rule)},onError:function(){e.hideLoading(),e.root.find("#agreementContent").html("暂时无法获取利用规则,请稍候重试！")}})},onShow:function($super){$super()},addAgreementMsg:function(e){this.removeAgreemntMsg(),this.root.find("#agreementContent").append('<div class="agreementContentMsg" style="width:100%;magin:0 auto;text-align:center;color:black;padding-bottom:20px">'+e+"</div>")},removeAgreemntMsg:function(){this.root.find("#agreementContent").find(".agreementContentMsg").remove()},onHide:function($super){r.hideMenu(this),$super()},onDispose:function($super){$super()},query:function(){this.root.find(".product-list").empty();var e=_favoriteStore.getValue();if(e==null||e.length<=0){this.root.find(".product-list").append('<div class="product-mod product-noData" ><div style="margin:0 auto;" >您没有收藏的数据!</div></div>');return}var t="";for(var n in e){var r=e[n];r.type===_currentScenicClassId&&(t+=this.listTemplateFun(e[n]))}t==""?this.root.find(".product-list").append('<div class="product-mod product-noData" ><div style="margin:0 auto;" >您没有收藏的数据!</div></div>'):(this.root.find(".product-list").find(".product-noData").remove(),this.root.find(".product-list").append(t))},bindSubRegion:function(){var e=this;_subregionListModel.param={cid:this.request.cid},_subregionListModel.execute({onSuccess:function(t){e.root.find(".area-pop ul").empty();if(t==null){e.root.find(".area-list").find(".iconfont").hide();return}if("length"in t&&t.length<=0){e.root.find(".area-list").find(".iconfont").hide();return}e.root.find(".area-list").find(".iconfont").show();var n="";for(var r=0,i=t.length;r<i;r+=1)n+="<li data-subreigonid="+t[r].rgn_id+"><a>"+t[r].rgn_name+"</a></li>";e.root.find(".area-pop ul").append(n),e.root.find(".area-pop ul").css({height:$(document.body).height()})},onError:function(){}})}};return new e.Class(t,o)}),define("text!RecommendAppViewHtml",[],function(){return'<div data-role="page" id="RecommendAppViewHtml" data-cache="true">\r\n    <div data-role="header" role="banner" data-position="fixed" data-tap-toggle="false" class="ms-header">\r\n        <div class="head-box">\r\n            <a href="#" class="header-back" title="返回上一页"><i class="iconfont icon-zuo1"></i></a>\r\n            <span class="header-title"  style="padding-right:47px">推荐应用</span>\r\n            <!--<span class="header-setup"><i class="iconfont icon-fenleihuaban"></i></span>-->\r\n        </div>\r\n    </div>\r\n    <div data-role="content" class="ms-content">\r\n        推荐APP\r\n    </div>\r\n    <div data-role="footer" data-position="fixed" class="ms-footer" data-tap-toggle="false">\r\n        <div class="footer-box">\r\n            <ul>\r\n                <li data-url="Index" data-url-type="app"><a><i class="iconfont icon-shouye"></i><span>首页</span></a></li>\r\n                <li data-url="RecommendList" data-url-type="web"><a><i class="iconfont icon-tuijiankehu"></i><span>推荐</span></a></li>\r\n                <li data-url="NearList" data-url-type="web"><a><i class="iconfont icon-zhoubianyou"></i><span>周边</span></a></li>\r\n                <li data-url="FavoriteList" data-url-type="web"><a><i class="iconfont icon-shoucangcc"></i><span>收藏</span></a></li>\r\n            </ul>\r\n        </div>\r\n    </div>\r\n\r\n</div>\r\n'}),define("RecommendAppController",["MsCore","NttTravelBaseController","text!RecommendAppViewHtml","NttNavWidget"],function(e,t,n,r){"use strict";var i={initialize:function($super,e){$super(e),this.injectHTML(n)},onCreate:function(){var e=this;this.pageName="recommend_app",this.root.find(".header-back").on("tap",function(){e.back()}),r.bindHeader(this),r.bindFooter(this)},onShow:function($super){$super()},onHide:function($super){r.hideMenu(this),$super()},onDispose:function($super){$super()}};return new e.Class(t,i)}),define("text!AppUpdateDesViewHtml",[],function(){return'<div data-role="page" id="AppUpdateDesViewHtml" data-cache="true">\r\n    <div data-role="header" role="banner" data-position="fixed" data-tap-toggle="false" class="ms-header">\r\n        <div class="head-box">\r\n            <a href="#" class="header-back" title="返回上一页"><i class="iconfont icon-zuo1"></i></a>\r\n            <span class="header-title" style="padding-right: 47px">版本更新信息</span>\r\n            <!-- <span class="header-setup"><i class="iconfont icon-fenleihuaban"></i></span>-->\r\n        </div>\r\n    </div>\r\n    <div data-role="content" class="ms-content">\r\n\r\n        <div class="index_agreement index_agreement_android" style="line-height: 18px; display: none">\r\n            <div class="atitle">Version 1.3 2015年8月24日</div>\r\n            <div class="acontent">\r\n                1.增加软件通知提醒功能；<br />\r\n                2.修改完善了一些服务程序的Bug。<br />\r\n            </div>\r\n\r\n\r\n            <div class="atitle">Version 1.2 2015年4月22日</div>\r\n            <div class="acontent">\r\n                1. 饮食有了新的类别筛选功能；<br />\r\n                2. 收藏功能也可以根据新的饮食类别筛选了；<br />\r\n                3. 修改完善了一些服务程序的Bug。<br />\r\n            </div>\r\n\r\n            <div class="atitle">Version 1.1	2015年3月17日</div>\r\n            <div class="acontent">\r\n                1.微博分享功能开启！\r\n                <br />\r\n                2.修改部分Bug。\r\n            </div>\r\n            <div class="atitle">Version 1.0	2015年2月1日</div>\r\n            <div class="acontent">\r\n                「优游日本」APP　Android版　正式发布！\r\n                <br />\r\n                「优游日本」手机应用旨在帮助赴日旅游的中国游客更便捷地获取专业、全面的日本「美食」「酒店」 信息！\r\n            </div>\r\n        </div>\r\n\r\n\r\n        <div class="index_agreement index_agreement_ios" style="line-height: 18px; display: none">\r\n            <div class="atitle">Version 1.2 2015年8月24日</div>\r\n            <div class="acontent">\r\n                1.增加软件通知提醒功能；<br />\r\n                2.修改完善了一些服务程序的Bug。<br />\r\n            </div>\r\n\r\n            <div class="atitle">Version 1.1 2015年4月30日</div>\r\n            <div class="acontent">\r\n                1. 微博分享功能开启；<br />\r\n                2. 饮食有了新的类别筛选功能；<br />\r\n                3. 收藏功能也可以根据新的饮食类别筛选了；<br />\r\n                4. 修改完善了一些服务程序的Bug。\r\n\r\n            </div>\r\n\r\n            <div class="atitle">Version 1.0 2015年2月1日</div>\r\n            <div class="acontent">\r\n                [优游日本]App iOS版本 正式发布！\r\n                <br />\r\n                [优游日本]手机应用旨在帮助赴日旅游的中国游客更便捷地获取专业、全面的日本[美食][酒店]信息！\r\n\r\n            </div>\r\n\r\n\r\n\r\n\r\n        </div>\r\n\r\n\r\n\r\n    </div>\r\n    <div data-role="footer" data-position="fixed" class="ms-footer" data-tap-toggle="false">\r\n        <div class="footer-box">\r\n            <ul>\r\n                <li data-url="Index" data-url-type="app"><a><i class="iconfont icon-shouye"></i><span>首页</span></a></li>\r\n                <li data-url="RecommendList" data-url-type="web"><a><i class="iconfont icon-tuijiankehu"></i><span>推荐</span></a></li>\r\n                <li data-url="NearList" data-url-type="web"><a><i class="iconfont icon-zhoubianyou"></i><span>周边</span></a></li>\r\n                <li data-url="FavoriteList" data-url-type="web"><a><i class="iconfont icon-shoucangcc"></i><span>收藏</span></a></li>\r\n            </ul>\r\n        </div>\r\n    </div>\r\n\r\n</div>\r\n'}),define("AppUpdateDesController",["MsCore","NttTravelBaseController","text!AppUpdateDesViewHtml","NttNavWidget"],function(e,t,n,r){"use strict";var i={initialize:function($super,e){$super(e),this.injectHTML(n)},onCreate:function(){var e=this;this.pageName="update_description",this.root.find(".header-back").on("tap",function(){e.back()}),r.bindHeader(this),r.bindFooter(this)},onShow:function($super){$super(),this.root.find(".index_agreement_android").hide(),this.root.find(".index_agreement_ios").hide(),window.navigator.userAgent.indexOf("MsWebviewIOS")>-1?this.root.find(".index_agreement_ios").show():this.root.find(".index_agreement_android").show()},onHide:function($super){r.hideMenu(this),$super()},onDispose:function($super){$super()}};return new e.Class(t,i)}),define("text!UserReportViewHtml",[],function(){return'<div data-role="page" id="UserAgreementView" data-cache="true">\r\n    <div data-role="header" role="banner" data-position="fixed" data-tap-toggle="false" class="ms-header">\r\n        <div class="head-box">\r\n            <a href="#" class="header-back" title="返回上一页"><i class="iconfont icon-zuo1"></i></a>\r\n            <span class="header-title" style="padding-right: 47px">意见反馈</span>\r\n            <!--<span class="header-setup"><i class="iconfont icon-fenleihuaban"></i></span>-->\r\n        </div>\r\n    </div>\r\n    <div data-role="content" class="ms-content">\r\n        <div class="content-recommend" >\r\n            <div class="index_agreement" style="line-height: 18px">\r\n                <div class=" needsclick needsfocus">\r\n                    <!--<input   type="text"  style="height:200px" />-->\r\n\r\n                    <textarea  maxlength="200" id="txtComment" style="width: 100%; height: 100%; border-left-width: 0px; \r\n                                     border-right-width: 0px; border-top-width: 0px; border-bottom-color: rgb(239, 80, 80); \r\n                                     border-bottom-left-radius: 5px; border-bottom-right-radius: 5px; line-height: 20px; \r\n                                     background: rgb(255, 241, 230); box-shadow: none;"\r\n                        placeholder="请留下您的宝贵建议，谢谢"  class=" needsclick "></textarea>\r\n\r\n\r\n                </div>\r\n                <div style="padding-bottom: 10px;font-size: 12px;color: #bababa;">剩余可输入字数：<span id="txtWordCount">200</span></div>\r\n                <button class="btn btnSubmit"  data-role="none">提交</button>\r\n\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div data-role="footer" data-position="fixed" class="ms-footer" data-tap-toggle="false">\r\n        <div class="footer-box">\r\n            <ul>\r\n                <li data-url="Index" data-url-type="app"><a><i class="iconfont icon-shouye"></i><span>首页</span></a></li>\r\n                <li data-url="RecommendList" data-url-type="web"><a><i class="iconfont icon-tuijiankehu"></i><span>推荐</span></a></li>\r\n                <li data-url="NearList" data-url-type="web"><a><i class="iconfont icon-zhoubianyou"></i><span>周边</span></a></li>\r\n                <li data-url="FavoriteList" data-url-type="web"><a><i class="iconfont icon-shoucangcc"></i><span>收藏</span></a></li>\r\n            </ul>\r\n        </div>\r\n    </div>\r\n<!--    <div class="setup-pop">\r\n        <a data-link="UserSetting">设置<i class="iconfont icon-shezhi"></i></a>\r\n        <a>WIFI<i class="iconfont icon-wifi"></i></a>\r\n        <a data-link="AboutUs">关于我们</a>\r\n        <a data-link="UserAgreement">利用规则</a>\r\n    </div>-->\r\n\r\n</div>\r\n'}),define("UserReportModel",["MsCore","NttTravelBaseModel"],function(e,t){"use strict";var n={__propertys__:function($super){$super(),this.path="/SubmitAdvise"},initialize:function($super,e){$super(e)}};return new e.Class(t,n)}),define("UserReportController",["MsCore","NttTravelBaseController","text!UserReportViewHtml","NttNavWidget","UserReportModel"],function(e,t,n,r,i){"use strict";var s=i.getInstance(),o={initialize:function($super,e){$super(e),this.injectHTML(n)},onCreate:function(){var e=this;this.root.find(".header-back").on("tap",function(){e.back()}),this.pageName="user_report",r.bindHeader(this),r.bindFooter(this),this.bindSubmit(),this.root.find("#txtComment").on("onpropertychange input",function(){var t=e.root.find("#txtComment").val();console.log(t.length),e.root.find("#txtWordCount").html(200-t.length)})},bindSubmit:function(){var e=this;this.root.find(".btnSubmit").on("click",function(){s.param={comment:e.root.find("#txtComment").val()};if(!s.param.comment||s.param.comment==""){window.MsJsBridge.showToast("您还没有输入反馈意见，无法提交");return}e.showLoading(),s.execute({onSuccess:function(){e.hideLoading(),window.MsJsBridge.showToast("提交成功，感谢您的支持！",function(){e.back()},this)},onError:function(){e.hideLoading(),window.MsJsBridge.showToast("提交失败，请稍候重试！")}})})},onBeforeShow:function($super){$super(),this.root.find("#txtComment").val("")},onShow:function($super){$super(),setTimeout($.proxy(function(){this.root.find("#txtComment").focus(),this.root.find("#txtComment").click()},this),500)},onHide:function($super){r.hideMenu(this),$super()},onDispose:function($super){$super()}};return new e.Class(t,o)});
